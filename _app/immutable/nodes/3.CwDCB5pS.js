var we=Object.defineProperty;var ge=(n,e,o)=>e in n?we(n,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):n[e]=o;var A=(n,e,o)=>ge(n,typeof e!="symbol"?e+"":e,o);import{a as Ce,b as me,g as pe,e as Q,i as Z}from"../chunks/BG5vw4S3.js";import{R as _e,w as ie,d as P,g as ue}from"../chunks/DDOTFIOd.js";import{t as V,a as k,c as ke,n as ve}from"../chunks/C4syPFph.js";import{i as O}from"../chunks/JLhUrqbI.js";import{h as ne,aC as ye,aD as Me,s as F,aE as se,F as z,aF as M,o as oe,aG as ae,w as g,x as f,t as L,X as H,m as r,v as U,i as fe,y as E,z as be,aH as ze,aI as Se,aJ as R}from"../chunks/Dcrv35hV.js";import{p,i as J}from"../chunks/ClKXfRuZ.js";import{l as xe,w as Be,e as T,s as Y}from"../chunks/bKSYLWGP.js";import{o as $}from"../chunks/DAtzh4O8.js";function K(n,e,o,t,l,s){var d=n.__className;if(ne||d!==o){var a=Ce(o,t,s);(!ne||a!==n.getAttribute("class"))&&(a==null?n.removeAttribute("class"):n.className=a),n.__className=o}else if(s&&l!==s)for(var c in s){var i=!!s[c];(l==null||i!==!!l[c])&&n.classList.toggle(c,i)}return s}function ce(n,e){xe(window,["resize"],()=>Be(()=>e(window[n])))}function de(n,e){throw new _e(n,e.toString())}new TextEncoder;const Ve=({url:n})=>{const e=n.searchParams.get("level");if(!e)throw de(303,"/");let o=n.searchParams.get("board");const t=o?me(o):null;if(!t)throw o=pe(e),de(303,`play?level=${e}&board=${o}`);return{levelId:e,board:t}},dt=Object.freeze(Object.defineProperty({__proto__:null,load:Ve},Symbol.toStringTag,{value:"Module"})),he=Symbol("sudoku-view-model");function Ae(n){ye(he,n)}function ee(){return Me(he)}var Ie=V('<span class="cell-value svelte-1rxeh6n"> </span>'),Ne=V('<span class="note-value svelte-1rxeh6n"></span>'),Ee=V('<div class="note-cell svelte-1rxeh6n"><!></div>'),De=V('<div class="notes-grid svelte-1rxeh6n"></div>'),Pe=V("<div><!></div>");function je(n,e){F(e,!1);const o=M();let t=p(e,"rowIndex",8),l=p(e,"colIndex",8),s=p(e,"cellValue",8),d=p(e,"isInitial",8),a=p(e,"notes",8),c=p(e,"selectedCell",8),i=p(e,"valueCounts",8),b=p(e,"violatedCells",8);const u=ee();function y(v,w){return u.isSameBox(v,w)}function S(v,w){return u.hasSameValue(v,w)}se(()=>(oe(b()),oe(t()),oe(l())),()=>{z(o,b().some(v=>v.row===t()&&v.col===l()))}),ae(),O();var m=Pe();let C;var x=g(m);{var _=v=>{var w=Ie(),j=g(w,!0);f(w),L(()=>Y(j,s())),k(v,w)},I=v=>{var w=ke(),j=fe(w);{var G=q=>{var D=De();Q(D,4,()=>Array(9).fill(null),Z,(W,h,N)=>{var X=Ee(),te=g(X);{var le=B=>{var re=Ne();re.textContent=N+1,k(B,re)};J(te,B=>{a()[N]&&B(le)})}f(X),k(W,X)}),f(D),k(q,D)};J(j,q=>{a().some(D=>D)&&q(G)})}k(v,w)};J(x,v=>{s()?v(_):v(I,!1)})}f(m),L(v=>C=K(m,1,"cell svelte-1rxeh6n",null,C,v),[()=>({selected:c().row===t()&&c().col===l(),"same-line":c().row===t()||c().col===l(),"same-box":y(t(),l())&&!(c().row===t()&&c().col===l()),"same-value":S(t(),l())&&!(c().row===t()&&c().col===l()),complete:s()&&i()[s()]>=9,violated:r(o),initial:d()})],H),T("click",m,()=>u.selectCell(t(),l())),k(n,m),U()}var qe=V("<div><!></div>"),Re=V('<div class="row svelte-11dzzjo"></div>'),Te=V('<div class="sudoku-board svelte-11dzzjo"></div>');function Ge(n,e){F(e,!1);let o=p(e,"board",24,()=>[]),t=p(e,"notes",24,()=>[]),l=p(e,"selectedCell",24,()=>({row:-1,col:-1}));const s=ee();let d=M([]),a=M([]);$(()=>{const i=s.valueCounts.subscribe(u=>{z(d,u)}),b=s.violatedCells.subscribe(u=>{z(a,u)});return()=>{i(),b()}}),O();var c=Te();Q(c,5,o,Z,(i,b,u)=>{var y=Re();Q(y,5,()=>r(b),Z,(S,m,C)=>{var x=qe();K(x,1,"cell svelte-11dzzjo",null,{},{"border-bottom-thick":u%3===2&&u<8,"border-right-thick":C%3===2&&C<8});var _=g(x);const I=H(()=>s.initialBoard[u][C]!==0);je(_,{rowIndex:u,colIndex:C,get cellValue(){return r(m)},get isInitial(){return r(I)},get notes(){return t()[u][C]},get selectedCell(){return l()},get valueCounts(){return r(d)},get violatedCells(){return r(a)}}),f(x),k(S,x)}),f(y),k(i,y)}),f(c),k(n,c),U()}var He=ve('<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path></svg>');function Le(n){var e=He();k(n,e)}var Oe=ve('<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 6L6 18"></path><path d="M6 6l12 12"></path></svg>');function Fe(n){var e=Oe();k(n,e)}var Ue=V("<button> </button>"),Ke=V('<div class="container svelte-wskw5z"><div class="digits-container svelte-wskw5z"><!> <button tabindex="-1" class="digit-button clear-btn svelte-wskw5z"><!></button></div> <div class="actions-container svelte-wskw5z"><button><!> <span>Note</span></button></div></div>');function We(n,e){F(e,!1);let o=p(e,"digitCounts",24,()=>Array(9).fill(0)),t=M(!1),l=M(!0);const s=ee();function d(_){s.enterDigit(_)}function a(){s.toggleNoteMode()}$(()=>{const _=s.noteMode.subscribe(v=>{z(t,v)}),I=s.cellEditable.subscribe(v=>{z(l,v)});return()=>{_(),I()}}),O();var c=Ke(),i=g(c),b=g(i);Q(b,0,()=>Array(9).fill(null),Z,(_,I,v)=>{var w=Ue();const j=H(()=>v+1),G=H(()=>o()[v]);let q;var D=g(w,!0);f(w),L(W=>{q=K(w,1,"digit-button svelte-wskw5z",null,q,W),w.disabled=r(G)>=9,Y(D,r(j))},[()=>({disabled:r(G)>=9})],H),T("click",w,()=>d(r(j))),k(_,w)});var u=E(b,2),y=g(u);Fe(y),f(u),f(i);var S=E(i,2),m=g(S);let C;var x=g(m);Le(x),be(2),f(m),f(S),f(c),L(_=>{u.disabled=!r(l),C=K(m,1,"action-button note-btn svelte-wskw5z",null,C,_)},[()=>({active:r(t)})],H),T("click",u,()=>s.clearSelectedCell()),T("click",m,a),k(n,c),U()}class Xe{constructor(e,o){A(this,"state");A(this,"board");A(this,"notes");A(this,"selectedCell");A(this,"noteMode");A(this,"levelId");A(this,"digitCounts");A(this,"valueCounts");A(this,"cellEditable");A(this,"violatedCells");A(this,"gameComplete");this.initialBoard=o,this.state=ie({initialBoard:o,board:o,notes:Array(9).fill(null).map(()=>Array(9).fill(null).map(()=>Array(9).fill(!1))),selectedCell:{row:-1,col:-1},noteMode:!1,levelId:e}),this.board=P(this.state,t=>t.board),this.notes=P(this.state,t=>t.notes),this.selectedCell=P(this.state,t=>t.selectedCell),this.noteMode=P(this.state,t=>t.noteMode),this.levelId=P(this.state,t=>t.levelId),this.digitCounts=P(this.board,t=>this.calculateDigitCounts(t)),this.valueCounts=P(this.board,t=>this.calculateValueCounts(t)),this.cellEditable=P(this.selectedCell,t=>this.isEditableCell(t.row,t.col)),this.violatedCells=P(this.board,t=>this.findViolatedCells(t)),this.gameComplete=ie(!1)}clearBoard(){this.state.update(e=>({...e,board:e.initialBoard,notes:Array(9).fill(null).map(()=>Array(9).fill(null).map(()=>Array(9).fill(!1))),selectedCell:{row:-1,col:-1},noteMode:!1})),this.gameComplete.set(!1)}selectCell(e,o){this.state.update(t=>({...t,selectedCell:{row:e,col:o}}))}toggleNoteMode(){this.state.update(e=>({...e,noteMode:!e.noteMode}))}enterDigit(e){this.state.update(o=>{const{row:t,col:l}=o.selectedCell;if(!this.isEditableCell(t,l))return o;const s=[...o.board.map(a=>[...a])],d=[...o.notes.map(a=>[...a.map(c=>[...c])])];return o.noteMode?d[t][l][e-1]=!d[t][l][e-1]:s[t][l]=e,{...o,board:s,notes:d}}),this.updateCompleteState()}clearSelectedCell(){this.state.update(e=>{const{row:o,col:t}=e.selectedCell;if(!this.isEditableCell(o,t))return e;const l=[...e.board.map(d=>[...d])],s=[...e.notes.map(d=>[...d.map(a=>[...a])])];return l[o][t]!==0?l[o][t]=0:s[o][t]=Array(9).fill(!1),{...e,board:l,notes:s}}),this.gameComplete.set(!1)}calculateDigitCounts(e){const o=Array(9).fill(0);for(let t=0;t<9;t++)for(let l=0;l<9;l++)e[t][l]>0&&o[e[t][l]-1]++;return o}calculateValueCounts(e){const o=Array(10).fill(0);for(let t=0;t<9;t++)for(let l=0;l<9;l++)e[t][l]&&o[e[t][l]]++;return o}isSameBox(e,o){let t;if(this.selectedCell.subscribe(i=>{t=i})(),!t||t.row===-1||t.col===-1)return!1;const s=Math.floor(e/3),d=Math.floor(o/3),a=Math.floor(t.row/3),c=Math.floor(t.col/3);return s===a&&d===c}hasSameValue(e,o){let t,l;if(this.selectedCell.subscribe(c=>{t=c})(),this.board.subscribe(c=>{l=c})(),!t||!l||t.row===-1||t.col===-1)return!1;const a=l[t.row][t.col];return!!(a&&l[e][o]===a)}isEditableCell(e,o){return e===-1||o===-1?!1:this.initialBoard[e][o]===0}findViolatedCells(e){const o=[],t=(l,s)=>o.some(d=>d.row===l&&d.col===s);for(let l=0;l<9;l++)for(let s=0;s<9;s++){const d=e[l][s];if(!d||t(l,s))continue;for(let i=0;i<9;i++)i!==s&&e[l][i]===d&&(t(l,s)||o.push({row:l,col:s}),t(l,i)||o.push({row:l,col:i}));for(let i=0;i<9;i++)i!==l&&e[i][s]===d&&(t(l,s)||o.push({row:l,col:s}),t(i,s)||o.push({row:i,col:s}));const a=Math.floor(l/3)*3,c=Math.floor(s/3)*3;for(let i=a;i<a+3;i++)for(let b=c;b<c+3;b++)(i!==l||b!==s)&&e[i][b]===d&&(t(l,s)||o.push({row:l,col:s}),t(i,b)||o.push({row:i,col:b}))}return o}updateCompleteState(){let e;if(this.board.subscribe(s=>{e=s})(),!e)return;if(!e.every(s=>s.every(d=>d>0))){this.gameComplete.set(!1);return}if(this.findViolatedCells(e).length>0){this.gameComplete.set(!1);return}this.gameComplete.set(!0)}}var Ye=V('<div class="overlay svelte-9kcqzz"><div class="complete-card svelte-9kcqzz"><h2 class="svelte-9kcqzz">Puzzle Completed!</h2> <p class="svelte-9kcqzz"> </p> <button class="new-game-btn svelte-9kcqzz">New Game</button></div></div>');function Je(n,e){F(e,!1);let o=p(e,"levelId",8);function t(){ue("/")}O();var l=Ye(),s=g(l),d=E(g(s),2),a=g(d);f(d);var c=E(d,2);f(s),f(l),L(()=>Y(a,`Congratulations! You've successfully completed the ${o()??""} puzzle.`)),T("click",c,t),k(n,l),U()}var Qe=V('<div class="header svelte-2otsas"><button class="back-btn svelte-2otsas">Back</button> <div class="title svelte-2otsas"><h1 class="svelte-2otsas"> </h1> <h2 class="svelte-2otsas"> </h2></div> <button class="clear-btn svelte-2otsas">Clear</button></div> <div class="tip svelte-2otsas">Tip: Select a cell and press 1-9 to enter values. Use note mode for candidates.</div>',1);function Ze(n,e){F(e,!1);const o=M();let t=p(e,"levelId",8),l=M(0);const s=ee();function d(){ue("/")}function a(){s.clearBoard()}$(()=>{const _=setInterval(()=>{ze(l)},1e3);return()=>{clearInterval(_)}}),se(()=>r(l),()=>{z(o,new Date(r(l)*1e3).toISOString().substr(11,8))}),ae(),O();var c=Qe(),i=fe(c),b=g(i),u=E(b,2),y=g(u),S=g(y,!0);f(y);var m=E(y,2),C=g(m,!0);f(m),f(u);var x=E(u,2);f(i),be(2),L(()=>{Y(S,t()),Y(C,r(o))}),T("click",b,d),T("click",x,a),k(n,c),U()}var $e=V('<div><!> <div><div class="board-container svelte-uv4xb"><!></div> <div class="controls-container svelte-uv4xb"><!></div></div> <!></div>');function et(n,e){F(e,!1);let o=p(e,"levelId",8),t=p(e,"initialBoard",8);const l=new Xe(o(),t());Ae(l);let s=M([]),d=M([]),a=M({row:-1,col:-1}),c=M(Array(9).fill(0)),i=M(!1),b=M(!1),u=M(0),y=M(0);$(()=>{const h=l.board.subscribe(B=>{z(s,B)}),N=l.notes.subscribe(B=>{z(d,B)}),X=l.selectedCell.subscribe(B=>{z(a,B)}),te=l.digitCounts.subscribe(B=>{z(c,B)}),le=l.gameComplete.subscribe(B=>{z(i,B)});return()=>{h(),N(),X(),te(),le()}});function S(h,N){r(a).row===-1||r(a).col===-1?(R(a,r(a).row=0),R(a,r(a).col=0)):(R(a,r(a).row+=h),R(a,r(a).col+=N)),r(a).row<0&&R(a,r(a).row=0),r(a).row>8&&R(a,r(a).row=8),r(a).col<0&&R(a,r(a).col=0),r(a).col>8&&R(a,r(a).col=8),l.selectCell(r(a).row,r(a).col)}function m(h){if(!r(i))if(h.key.match(/[1-9]/)){const N=parseInt(h.key,10);l.enterDigit(N)}else h.key==="Backspace"?l.clearSelectedCell():h.key==="Enter"?l.toggleNoteMode():h.key==="ArrowUp"?S(-1,0):h.key==="ArrowDown"?S(1,0):h.key==="ArrowLeft"?S(0,-1):h.key==="ArrowRight"&&S(0,1)}se(()=>(r(u),r(y)),()=>{z(b,r(u)>r(y)&&r(u)>=768)}),ae(),O();var C=$e();T("keydown",Se,m);let x;var _=g(C);Ze(_,{get levelId(){return o()}});var I=E(_,2);let v;var w=g(I),j=g(w);Ge(j,{get board(){return r(s)},get notes(){return r(d)},get selectedCell(){return r(a)}}),f(w);var G=E(w,2),q=g(G);We(q,{get digitCounts(){return r(c)}}),f(G),f(I);var D=E(I,2);{var W=h=>{Je(h,{get levelId(){return o()}})};J(D,h=>{r(i)&&h(W)})}f(C),L((h,N)=>{x=K(C,1,"container svelte-uv4xb",null,x,h),v=K(I,1,"game-content svelte-uv4xb",null,v,N)},[()=>({"wide-layout":r(b)}),()=>({"wide-layout":r(b)})],H),ce("innerWidth",h=>z(u,h)),ce("innerHeight",h=>z(y,h)),k(n,C),U()}function ut(n,e){F(e,!1);let o=p(e,"data",8);O(),et(n,{get levelId(){return o().levelId},get initialBoard(){return o().board}}),U()}export{ut as component,dt as universal};
