var he=Object.defineProperty;var ge=(n,e,o)=>e in n?he(n,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):n[e]=o;var z=(n,e,o)=>ge(n,typeof e!="symbol"?e+"":e,o);import{a as Ce,b as me,g as we,e as ee,i as te}from"../chunks/CDP4jprq.js";import{R as pe,w as ne,d as P,g as ve,b as fe}from"../chunks/DeToJkJk.js";import{t as A,a as M,c as _e,n as ye}from"../chunks/C__5v9kr.js";import{i as F}from"../chunks/Dj8PqmZs.js";import{o as ce,aC as Me,aD as ke,s as U,aE as le,F as S,aF as y,f as ae,aG as ie,w as C,x as h,t as q,X as L,g as i,v as K,q as Se,y as x,z as Be,aH as Ve,aI as Ae,aJ as R}from"../chunks/DYrX2ids.js";import{p as _,i as $}from"../chunks/Dr2BO5k9.js";import{l as ze,w as Ie,e as G,s as J}from"../chunks/DtG3s25q.js";import{o as oe}from"../chunks/BiPqryrm.js";function O(n,e,o,t,l,s){var c=n.__className;if(ce||c!==o){var d=Ce(o,t,s);(!ce||d!==n.getAttribute("class"))&&(d==null?n.removeAttribute("class"):n.className=d),n.__className=o}else if(s&&l!==s)for(var a in s){var r=!!s[a];(l==null||r!==!!l[a])&&n.classList.toggle(a,r)}return s}function de(n,e){ze(window,["resize"],()=>Ie(()=>e(window[n])))}function ue(n,e){throw new pe(n,e.toString())}new TextEncoder;const xe=({url:n})=>{const e=n.searchParams.get("level");if(!e)throw ue(303,"/");let o=n.searchParams.get("board");const t=o?me(o):null;if(!t)throw o=we(e),ue(303,`play?level=${e}&board=${o}`);return{levelId:e,board:t}},vt=Object.freeze(Object.defineProperty({__proto__:null,load:xe},Symbol.toStringTag,{value:"Module"})),be=Symbol("sudoku-view-model");function Ne(n){Me(be,n)}function se(){return ke(be)}var Ee=A('<span class="cell-value svelte-1eel9hg"> </span>'),De=A('<span class="note-value svelte-1eel9hg"></span>'),je=A('<div class="note-cell svelte-1eel9hg"><!></div>'),Pe=A('<div class="notes-grid svelte-1eel9hg"></div>'),Te=A("<div><!></div>");function Re(n,e){U(e,!1);const o=y();let t=_(e,"rowIndex",8),l=_(e,"colIndex",8),s=_(e,"cellValue",8),c=_(e,"isInitial",8),d=_(e,"notes",8),a=_(e,"selectedCell",8),r=_(e,"valueCounts",8),b=_(e,"violatedCells",8);const v=se();function w(u,g){return v.isSameBox(u,g)}function m(u,g){return v.hasSameValue(u,g)}le(()=>(ae(b()),ae(t()),ae(l())),()=>{S(o,b().some(u=>u.row===t()&&u.col===l()))}),ie(),F();var p=Te();let B;var k=C(p);{var V=u=>{var g=Ee(),I=C(g,!0);h(g),q(()=>J(I,s())),M(u,g)},E=u=>{var g=_e(),I=Se(g);{var H=T=>{var N=Pe();ee(N,4,()=>Array(9).fill(null),te,(W,re,Q)=>{var f=je(),D=C(f);{var X=Y=>{var Z=De();Z.textContent=Q+1,M(Y,Z)};$(D,Y=>{d()[Q]&&Y(X)})}h(f),M(W,f)}),h(N),M(T,N)};$(I,T=>{d().some(N=>N)&&T(H)})}M(u,g)};$(k,u=>{s()?u(V):u(E,!1)})}h(p),q(u=>B=O(p,1,"cell svelte-1eel9hg",null,B,u),[()=>({selected:a().row===t()&&a().col===l(),"same-line":a().row===t()||a().col===l(),"same-box":w(t(),l())&&!(a().row===t()&&a().col===l()),"same-value":m(t(),l())&&!(a().row===t()&&a().col===l()),complete:s()&&r()[s()]>=9,violated:i(o),initial:c()})],L),G("click",p,()=>v.selectCell(t(),l())),M(n,p),K()}var Ge=A("<div><!></div>"),He=A('<div class="row svelte-cpzb4l"></div>'),Le=A('<div class="sudoku-board svelte-cpzb4l"></div>');function Oe(n,e){U(e,!1);let o=_(e,"board",24,()=>[]),t=_(e,"notes",24,()=>[]),l=_(e,"selectedCell",24,()=>({row:-1,col:-1}));const s=se();let c=y([]),d=y([]);oe(()=>{const r=s.valueCounts.subscribe(v=>{S(c,v)}),b=s.violatedCells.subscribe(v=>{S(d,v)});return()=>{r(),b()}}),F();var a=Le();ee(a,5,o,te,(r,b,v)=>{var w=He();ee(w,5,()=>i(b),te,(m,p,B)=>{var k=Ge();O(k,1,"cell svelte-cpzb4l",null,{},{"border-bottom-thick":v%3===2&&v<8,"border-right-thick":B%3===2&&B<8});var V=C(k);const E=L(()=>s.initialBoard[v][B]!==0);Re(V,{rowIndex:v,colIndex:B,get cellValue(){return i(p)},get isInitial(){return i(E)},get notes(){return t()[v][B]},get selectedCell(){return l()},get valueCounts(){return i(c)},get violatedCells(){return i(d)}}),h(k),M(m,k)}),h(w),M(r,w)}),h(a),M(n,a),K()}var qe=ye('<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path></svg>');function Fe(n){var e=qe();M(n,e)}var Ue=A('<div class="tip svelte-1h2zn7p">Tip: Select a cell and press 1-9 to enter values. Use note mode for candidates.</div>');function Ke(n){var e=Ue();M(n,e)}var We=A("<button> </button>"),Xe=A('<div class="container svelte-1zj3si"><div class="digits-container svelte-1zj3si"><!> <button class="digit-button clear-btn svelte-1zj3si"><span>&#10005;</span></button></div> <div class="actions-container svelte-1zj3si"><button><!> <span>Note</span></button></div> <!></div>');function Ye(n,e){U(e,!1);let o=_(e,"digitCounts",24,()=>Array(9).fill(0)),t=y(!1),l=y(!0);const s=se();function c(V){s.enterDigit(V)}function d(){s.toggleNoteMode()}oe(()=>{const V=s.noteMode.subscribe(u=>{S(t,u)}),E=s.cellEditable.subscribe(u=>{S(l,u)});return()=>{V(),E()}}),F();var a=Xe(),r=C(a),b=C(r);ee(b,0,()=>Array(9).fill(null),te,(V,E,u)=>{var g=We();const I=L(()=>u+1),H=L(()=>o()[u]);let T;var N=C(g,!0);h(g),q(W=>{T=O(g,1,"digit-button svelte-1zj3si",null,T,W),g.disabled=i(H)>=9,J(N,i(I))},[()=>({disabled:i(H)>=9})],L),G("click",g,()=>c(i(I))),M(V,g)});var v=x(b,2);h(r);var w=x(r,2),m=C(w);let p;var B=C(m);Fe(B),Be(2),h(m),h(w);var k=x(w,2);Ke(k),h(a),q(V=>{v.disabled=!i(l),p=O(m,1,"action-button note-btn svelte-1zj3si",null,p,V)},[()=>({active:i(t)})],L),G("click",v,()=>s.clearSelectedCell()),G("click",m,d),M(n,a),K()}class Je{constructor(e,o){z(this,"state");z(this,"board");z(this,"notes");z(this,"selectedCell");z(this,"noteMode");z(this,"levelId");z(this,"digitCounts");z(this,"valueCounts");z(this,"cellEditable");z(this,"violatedCells");z(this,"gameComplete");this.initialBoard=o,this.state=ne({initialBoard:o,board:o,notes:Array(9).fill(null).map(()=>Array(9).fill(null).map(()=>Array(9).fill(!1))),selectedCell:{row:-1,col:-1},noteMode:!1,levelId:e}),this.board=P(this.state,t=>t.board),this.notes=P(this.state,t=>t.notes),this.selectedCell=P(this.state,t=>t.selectedCell),this.noteMode=P(this.state,t=>t.noteMode),this.levelId=P(this.state,t=>t.levelId),this.digitCounts=P(this.board,t=>this.calculateDigitCounts(t)),this.valueCounts=P(this.board,t=>this.calculateValueCounts(t)),this.cellEditable=P(this.selectedCell,t=>this.isEditableCell(t.row,t.col)),this.violatedCells=P(this.board,t=>this.findViolatedCells(t)),this.gameComplete=ne(!1)}clearBoard(){this.state.update(e=>({...e,board:e.initialBoard,notes:Array(9).fill(null).map(()=>Array(9).fill(null).map(()=>Array(9).fill(!1))),selectedCell:{row:-1,col:-1},noteMode:!1})),this.gameComplete.set(!1)}selectCell(e,o){this.state.update(t=>({...t,selectedCell:{row:e,col:o}}))}toggleNoteMode(){this.state.update(e=>({...e,noteMode:!e.noteMode}))}enterDigit(e){this.state.update(o=>{const{row:t,col:l}=o.selectedCell;if(!this.isEditableCell(t,l))return o;const s=[...o.board.map(d=>[...d])],c=[...o.notes.map(d=>[...d.map(a=>[...a])])];return o.noteMode?c[t][l][e-1]=!c[t][l][e-1]:s[t][l]=e,{...o,board:s,notes:c}}),this.updateCompleteState()}clearSelectedCell(){this.state.update(e=>{const{row:o,col:t}=e.selectedCell;if(!this.isEditableCell(o,t))return e;const l=[...e.board.map(c=>[...c])],s=[...e.notes.map(c=>[...c.map(d=>[...d])])];return l[o][t]!==0?l[o][t]=0:s[o][t]=Array(9).fill(!1),{...e,board:l,notes:s}}),this.gameComplete.set(!1)}calculateDigitCounts(e){const o=Array(9).fill(0);for(let t=0;t<9;t++)for(let l=0;l<9;l++)e[t][l]>0&&o[e[t][l]-1]++;return o}calculateValueCounts(e){const o=Array(10).fill(0);for(let t=0;t<9;t++)for(let l=0;l<9;l++)e[t][l]&&o[e[t][l]]++;return o}isSameBox(e,o){let t;if(this.selectedCell.subscribe(r=>{t=r})(),!t||t.row===-1||t.col===-1)return!1;const s=Math.floor(e/3),c=Math.floor(o/3),d=Math.floor(t.row/3),a=Math.floor(t.col/3);return s===d&&c===a}hasSameValue(e,o){let t,l;if(this.selectedCell.subscribe(a=>{t=a})(),this.board.subscribe(a=>{l=a})(),!t||!l||t.row===-1||t.col===-1)return!1;const d=l[t.row][t.col];return!!(d&&l[e][o]===d)}isEditableCell(e,o){return e===-1||o===-1?!1:this.initialBoard[e][o]===0}findViolatedCells(e){const o=[],t=(l,s)=>o.some(c=>c.row===l&&c.col===s);for(let l=0;l<9;l++)for(let s=0;s<9;s++){const c=e[l][s];if(!c||t(l,s))continue;for(let r=0;r<9;r++)r!==s&&e[l][r]===c&&(t(l,s)||o.push({row:l,col:s}),t(l,r)||o.push({row:l,col:r}));for(let r=0;r<9;r++)r!==l&&e[r][s]===c&&(t(l,s)||o.push({row:l,col:s}),t(r,s)||o.push({row:r,col:s}));const d=Math.floor(l/3)*3,a=Math.floor(s/3)*3;for(let r=d;r<d+3;r++)for(let b=a;b<a+3;b++)(r!==l||b!==s)&&e[r][b]===c&&(t(l,s)||o.push({row:l,col:s}),t(r,b)||o.push({row:r,col:b}))}return o}updateCompleteState(){let e;if(this.board.subscribe(s=>{e=s})(),!e)return;if(!e.every(s=>s.every(c=>c>0))){this.gameComplete.set(!1);return}if(this.findViolatedCells(e).length>0){this.gameComplete.set(!1);return}this.gameComplete.set(!0)}}var Qe=A('<div class="overlay svelte-e4go0s"><div class="complete-card svelte-e4go0s"><h2 class="svelte-e4go0s">Puzzle Completed!</h2> <p class="svelte-e4go0s"> </p> <button class="new-game-btn svelte-e4go0s">New Game</button></div></div>');function Ze(n,e){U(e,!1);let o=_(e,"levelId",8);function t(){ve(`${fe}/`)}F();var l=Qe(),s=C(l),c=x(C(s),2),d=C(c);h(c);var a=x(c,2);h(s),h(l),q(()=>J(d,`Congratulations! You've successfully completed the ${o()??""} puzzle.`)),G("click",a,t),M(n,l),K()}var $e=A('<div class="header svelte-1o91g5p"><button class="back-btn svelte-1o91g5p">Back</button> <div class="title svelte-1o91g5p"><h1 class="svelte-1o91g5p"> </h1> <h2 class="svelte-1o91g5p"> </h2></div> <button class="clear-btn svelte-1o91g5p">Clear</button></div>');function et(n,e){U(e,!1);const o=y();let t=_(e,"levelId",8),l=y(0);const s=se();function c(){ve(`${fe}/`)}function d(){s.clearBoard()}oe(()=>{const k=setInterval(()=>{Ve(l)},1e3);return()=>{clearInterval(k)}}),le(()=>i(l),()=>{S(o,new Date(i(l)*1e3).toISOString().substr(11,8))}),ie(),F();var a=$e(),r=C(a),b=x(r,2),v=C(b),w=C(v,!0);h(v);var m=x(v,2),p=C(m,!0);h(m),h(b);var B=x(b,2);h(a),q(()=>{J(w,t()),J(p,i(o))}),G("click",r,c),G("click",B,d),M(n,a),K()}var tt=A('<div><!> <div><div><!></div> <div class="controls-container svelte-1lnc43"><!></div></div> <!></div>');function lt(n,e){U(e,!1);const o=y();let t=_(e,"levelId",8),l=_(e,"initialBoard",8);const s=new Je(t(),l());Ne(s);let c=y([]),d=y([]),a=y({row:-1,col:-1}),r=y(Array(9).fill(0)),b=y(!1),v=y(!1),w=y(0),m=y(0);oe(()=>{const f=s.board.subscribe(j=>{S(c,j)}),D=s.notes.subscribe(j=>{S(d,j)}),X=s.selectedCell.subscribe(j=>{S(a,j)}),Y=s.digitCounts.subscribe(j=>{S(r,j)}),Z=s.gameComplete.subscribe(j=>{S(b,j)});return()=>{f(),D(),X(),Y(),Z()}});function p(f,D){i(a).row===-1||i(a).col===-1?(R(a,i(a).row=0),R(a,i(a).col=0)):(R(a,i(a).row+=f),R(a,i(a).col+=D)),i(a).row<0&&R(a,i(a).row=0),i(a).row>8&&R(a,i(a).row=8),i(a).col<0&&R(a,i(a).col=0),i(a).col>8&&R(a,i(a).col=8),s.selectCell(i(a).row,i(a).col)}function B(f){if(!i(b))if(f.key.match(/[1-9]/)){const D=parseInt(f.key,10);s.enterDigit(D)}else f.key==="Backspace"?s.clearSelectedCell():f.key==="Enter"?s.toggleNoteMode():f.key==="ArrowUp"?p(-1,0):f.key==="ArrowDown"?p(1,0):f.key==="ArrowLeft"?p(0,-1):f.key==="ArrowRight"&&p(0,1)}le(()=>(i(w),i(m)),()=>{S(v,i(w)>i(m))}),le(()=>(i(m),i(v),i(w)),()=>{S(o,i(m)>0&&!i(v)&&i(w)/i(m)>.65)}),ie(),F();var k=tt();G("keydown",Ae,B);let V;var E=C(k);et(E,{get levelId(){return t()}});var u=x(E,2);let g;var I=C(u);let H;var T=C(I);Oe(T,{get board(){return i(c)},get notes(){return i(d)},get selectedCell(){return i(a)}}),h(I);var N=x(I,2),W=C(N);Ye(W,{get digitCounts(){return i(r)}}),h(N),h(u);var re=x(u,2);{var Q=f=>{Ze(f,{get levelId(){return t()}})};$(re,f=>{i(b)&&f(Q)})}h(k),q((f,D,X)=>{V=O(k,1,"container svelte-1lnc43",null,V,f),g=O(u,1,"game-content svelte-1lnc43",null,g,D),H=O(I,1,"board-container svelte-1lnc43",null,H,X)},[()=>({"wide-layout":i(v)}),()=>({"wide-layout":i(v)}),()=>({"square-layout":i(o)})],L),de("innerWidth",f=>S(w,f)),de("innerHeight",f=>S(m,f)),M(n,k),K()}function ft(n,e){U(e,!1);let o=_(e,"data",8);F(),lt(n,{get levelId(){return o().levelId},get initialBoard(){return o().board}}),K()}export{ft as component,vt as universal};
