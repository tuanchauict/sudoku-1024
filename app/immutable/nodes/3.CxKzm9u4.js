var ke=Object.defineProperty;var Me=(a,e,l)=>e in a?ke(a,e,{enumerable:!0,configurable:!0,writable:!0,value:l}):a[e]=l;var I=(a,e,l)=>Me(a,typeof e!="symbol"?e+"":e,l);import{b as Be,d as Ie,g as Ne,a as F,e as Q,i as Z,c as Ae,f as me,L as $,D as xe}from"../chunks/BsVY_UFX.js";import{R as Ve,w as K,d as J,g as pe}from"../chunks/eVIuV45n.js";import{t as A,a as y,c as Ee,n as ge}from"../chunks/DqXwdAxK.js";import"../chunks/BfK0U9aN.js";import{j as ce,aH as Pe,aI as Ge,p as z,A as S,aG as _,aJ as ee,e as ae,aK as ie,o as w,q as b,t as L,V as H,g as c,n as O,m as we,s as G,v as ue,$ as Ce,aL as Ue,aM as De}from"../chunks/D4frfRg2.js";import{l as je,w as Te,e as T,s as W,h as Se}from"../chunks/DzLTvIni.js";import{i as q}from"../chunks/DQpucoam.js";import{p as P,i as re}from"../chunks/jNJZQ3UP.js";import{o as Y}from"../chunks/CxcJMqRD.js";function R(a,e,l,t,s,o){var n=a.__className;if(ce||n!==l){var u=Be(l,t,o);(!ce||u!==a.getAttribute("class"))&&(u==null?a.removeAttribute("class"):a.className=u),a.__className=l}else if(o&&s!==o)for(var r in o){var i=!!o[r];(s==null||i!==!!s[r])&&a.classList.toggle(r,i)}return o}function de(a,e){je(window,["resize"],()=>Te(()=>e(window[a])))}function Le(a){const e=Ie(a);if(e===null||e.length!==81)return null;const l=[];for(let t=0;t<9;t++){const s=[];for(let o=0;o<9;o++)s.push(e[t*9+o]);l.push(s)}return l}function X(a,e){throw new Ve(a,e.toString())}new TextEncoder;const He=({url:a})=>{const e=a.searchParams.get("game");if(!e)throw X(303,F("/"));const l=parseInt(e[0]);if(isNaN(l)||l<1||l>4)throw X(303,F("/"));const t=l;if(!t)throw X(303,F("/"));let s=e.substring(1);const o=s?Le(s):null;if(!o)throw s=Ne.generateBoardString(t),X(303,`play?game=${l}${s}`);return{levelId:t,board:o}},It=Object.freeze(Object.defineProperty({__proto__:null,load:He},Symbol.toStringTag,{value:"Module"})),_e=Symbol("sudoku-view-model");function Re(a){Pe(_e,a)}function te(){return Ge(_e)}var ze=A('<span class="cell-value svelte-1a0uup5"> </span>'),Oe=A('<div class="note-cell svelte-1a0uup5"><span class="note-value svelte-1a0uup5"></span></div>'),qe=A('<div class="notes-grid svelte-1a0uup5"></div>'),Ke=A("<div><!></div>");function Je(a,e){z(e,!1);const l=_();let t=P(e,"rowIndex",8),s=P(e,"colIndex",8),o=P(e,"cellValue",8),n=P(e,"isInitial",8),u=P(e,"notes",8),r=P(e,"selectedCell",8),i=P(e,"valueCounts",8),k=P(e,"violatedCells",8);const f=te();let p=_(!1);function M(v,C){return f.isSameBox(v,C)}function g(v,C){return f.hasSameValue(v,C)}Y(()=>{const v=f.noteMode.subscribe(C=>{S(p,C)});return()=>{v()}}),ee(()=>(ae(k()),ae(t()),ae(s())),()=>{S(l,k().some(v=>v.row===t()&&v.col===s()))}),ie(),q();var h=Ke();let B;var U=w(h);{var D=v=>{var C=ze(),N=w(C,!0);b(C),L(()=>W(N,o())),y(v,C)},x=v=>{var C=qe();Q(C,4,()=>Array(9).fill(null),Z,(N,V,d)=>{var E=Ee(),m=we(E);{var le=se=>{var oe=Oe(),ye=w(oe);ye.textContent=d+1,b(oe),y(se,oe)};re(m,se=>{u()[d]&&se(le)})}y(N,E)}),b(C),y(v,C)};re(U,v=>{o()?v(D):v(x,!1)})}b(h),L(v=>B=R(h,1,"cell svelte-1a0uup5",null,B,v),[()=>({"note-mode":c(p),selected:r().row===t()&&r().col===s(),"same-line":r().row===t()||r().col===s(),"same-box":M(t(),s())&&!(r().row===t()&&r().col===s()),"same-value":g(t(),s())&&!(r().row===t()&&r().col===s()),complete:o()&&i()[o()]>=9,violated:c(l),initial:n()})],H),T("click",h,()=>f.selectCell(t(),s())),y(a,h),O()}var Fe=A("<div><!></div>"),We=A('<div class="row svelte-41cq0t"></div>'),Ye=A('<div class="sudoku-board svelte-41cq0t"></div>');function Xe(a,e){z(e,!1);let l=_([]),t=_([]),s=_({row:-1,col:-1});const o=te();let n=_([]),u=_([]);Y(()=>{const i=o.board.subscribe(g=>{S(l,g)}),k=o.notes.subscribe(g=>{S(t,g)}),f=o.selectedCell.subscribe(g=>{S(s,g)}),p=o.valueCounts.subscribe(g=>{S(n,g)}),M=o.violatedCells.subscribe(g=>{S(u,g)});return()=>{i(),k(),f(),p(),M()}}),q();var r=Ye();Q(r,5,()=>c(l),Z,(i,k,f)=>{var p=We();Q(p,5,()=>c(k),Z,(M,g,h)=>{var B=Fe();R(B,1,"cell svelte-41cq0t",null,{},{"border-bottom-thick":f%3===2&&f<8,"border-right-thick":h%3===2&&h<8});var U=w(B);const D=H(()=>o.isInitial(f,h));Je(U,{rowIndex:f,colIndex:h,get cellValue(){return c(g)},get isInitial(){return c(D)},get notes(){return c(t)[f][h]},get selectedCell(){return c(s)},get valueCounts(){return c(n)},get violatedCells(){return c(u)}}),b(B),y(M,B)}),b(p),y(i,p)}),b(r),y(a,r),O()}var Qe=ge('<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path></svg>');function Ze(a){var e=Qe();y(a,e)}var $e=A('<div class="container svelte-1kf9c29"><p class="tip svelte-1kf9c29">Tip: Select a cell and press 1-9 to enter values. Use note mode for candidates.</p> <p class="tip svelte-1kf9c29">Any issue or suggestion? <br>Please report on <a href="https://github.com/tuanchauict/sudoku-1024/" target="_blank" class="svelte-1kf9c29">GitHub</a> of the project.</p></div>');function et(a){var e=$e();y(a,e)}var tt=ge('<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" stroke="none" viewBox="0 0 24 24"><path d="M12.5 8c-2.65 0-5.05.99-6.9 2.6L2 7v9h9l-3.62-3.62c1.39-1.16 3.16-1.88 5.12-1.88 3.54 0 6.55 2.31 7.6 5.5l2.37-.78C21.08 11.03 17.15 8 12.5 8z"></path></svg>');function lt(a){var e=tt();y(a,e)}var st=A('<button tabindex="-1"> </button>'),ot=A('<div class="container svelte-84d01j"><div class="digits-container svelte-84d01j"><!> <button class="btn clear-btn svelte-84d01j" tabindex="-1"><span>&#10005;</span></button></div> <div class="actions-container svelte-84d01j"><button class="btn action-button svelte-84d01j" tabindex="-1"><!> <span>Undo</span></button> <button tabindex="-1"><!> <span>Note</span></button></div> <!></div>');function at(a,e){z(e,!1);let l=_(Array(10).fill(0)),t=_(!1),s=_(!0),o=_(!1);const n=te();function u(x){n.enterDigit(x)}Y(()=>{const x=n.noteMode.subscribe(V=>{S(t,V)}),v=n.cellEditable.subscribe(V=>{S(s,V)}),C=n.canUndo.subscribe(V=>{S(o,V)}),N=n.valueCounts.subscribe(V=>{S(l,V)});return()=>{x(),v(),C(),N()}}),q();var r=ot(),i=w(r),k=w(i);Q(k,0,()=>Array(9).fill(null),Z,(x,v,C)=>{var N=st();const V=H(()=>C+1),d=H(()=>c(l)[C+1]);let E;var m=w(N,!0);b(N),L(le=>{E=R(N,1,"btn digit-button svelte-84d01j",null,E,le),N.disabled=c(d)>=9,W(m,c(V))},[()=>({disabled:c(d)>=9})],H),T("click",N,()=>u(c(V))),y(x,N)});var f=G(k,2);b(i);var p=G(i,2),M=w(p),g=w(M);lt(g),ue(2),b(M);var h=G(M,2);let B;var U=w(h);Ze(U),ue(2),b(h),b(p);var D=G(p,2);et(D),b(r),L(x=>{f.disabled=!c(s),M.disabled=!c(o),B=R(h,1,"btn action-button note-btn svelte-84d01j",null,B,x)},[()=>({active:c(t)})],H),T("click",f,()=>n.clearSelectedCell()),T("click",M,()=>n.undo()),T("click",h,()=>n.toggleNoteMode()),y(a,r),O()}const rt="sudoku";class ve{static saveCurrentGame(e,l,t){const s={state:l,timePass:t};localStorage.setItem(fe(e),JSON.stringify(s))}static loadCurrentGame(e){const l=localStorage.getItem(fe(e));if(!l)return null;const t=JSON.parse(l);return t.state?t:null}}function fe(a){const e=a.flatMap(l=>l);return`${rt}_${Ae(e)}`}function ne(a,e){return JSON.stringify(a)===JSON.stringify(e)}function j(a){let e;return a.subscribe(t=>{e=t})(),e}function be(a){const e=[],l=(t,s)=>e.some(o=>o.row===t&&o.col===s);for(let t=0;t<9;t++)for(let s=0;s<9;s++){const o=a[t][s];if(!o||l(t,s))continue;for(let r=0;r<9;r++)r!==s&&a[t][r]===o&&(l(t,s)||e.push({row:t,col:s}),l(t,r)||e.push({row:t,col:r}));for(let r=0;r<9;r++)r!==t&&a[r][s]===o&&(l(t,s)||e.push({row:t,col:s}),l(r,s)||e.push({row:r,col:s}));const n=Math.floor(t/3)*3,u=Math.floor(s/3)*3;for(let r=n;r<n+3;r++)for(let i=u;i<u+3;i++)(r!==t||i!==s)&&a[r][i]===o&&(l(t,s)||e.push({row:t,col:s}),l(r,i)||e.push({row:r,col:i}))}return e}function nt(a,e){for(let l=0;l<9;l++)for(let t=0;t<9;t++)if(e.board[l][t]!==a.board[l][t])return{row:l,col:t};for(let l=0;l<9;l++)for(let t=0;t<9;t++)if(!ne(e.notes[l][t],a.notes[l][t]))return{row:l,col:t};return{row:0,col:0}}function it(a){const e=Array(10).fill(0);for(let l=0;l<9;l++)for(let t=0;t<9;t++)a[l][t]&&e[a[l][t]]++;return e}const he=me(0,Array(9).fill(Array(9).fill(0)));class ct{constructor(){I(this,"initialBoard",he.initialBoard);I(this,"state",K(he));I(this,"stateHistoryStack",[]);I(this,"board");I(this,"notes");I(this,"selectedCell");I(this,"noteMode",K(!1));I(this,"valueCounts");I(this,"cellEditable");I(this,"violatedCells");I(this,"gameComplete",K(!1));I(this,"timePass",K(0));I(this,"timeStart",K(Date.now()));I(this,"canUndo",K(!1));this.board=J(this.state,e=>e.board),this.notes=J(this.state,e=>e.notes),this.selectedCell=J(this.state,e=>e.selectedCell),this.valueCounts=J(this.board,e=>it(e)),this.cellEditable=J(this.selectedCell,e=>this.isEditableCell(e.row,e.col)),this.violatedCells=J(this.board,e=>be(e))}init(e,l){const t=ve.loadCurrentGame(l),s=t?t.state:me(e,l);this.state.set(s),this.initialBoard=l,this.stateHistoryStack.length=0,this.timePass.set(t?t.timePass:0),this.timeStart.set(Date.now())}get isInNodeMode(){return j(this.noteMode)}clearBoard(){this.updateState(e=>({...e,board:this.initialBoard,notes:Array(9).fill(null).map(()=>Array(9).fill(null).map(()=>Array(9).fill(!1))),noteMode:!1})),this.gameComplete.set(!1)}selectCell(e,l){this.updateState(t=>({...t,selectedCell:{row:e,col:l}}))}toggleNoteMode(){this.noteMode.set(!this.isInNodeMode)}enterDigit(e){this.updateState(l=>{const{row:t,col:s}=l.selectedCell;if(!this.isEditableCell(t,s))return l;const o=[...l.board.map(u=>[...u])],n=[...l.notes.map(u=>[...u.map(r=>[...r])])];if(this.isInNodeMode)n[t][s][e-1]=!n[t][s][e-1];else{o[t][s]=e;const u=Math.floor(t/3)*3,r=Math.floor(s/3)*3;for(let i=0;i<9;i++){n[t][i][e-1]=!1,n[i][s][e-1]=!1;const k=u+Math.floor(i/3),f=r+i%3;n[k][f][e-1]=!1}}return{...l,board:o,notes:n}}),this.updateCompleteState()}clearSelectedCell(){this.updateState(e=>{const{row:l,col:t}=e.selectedCell;if(!this.isEditableCell(l,t))return e;const s=[...e.board.map(n=>[...n])],o=[...e.notes.map(n=>[...n.map(u=>[...u])])];return s[l][t]!==0?s[l][t]=0:o[l][t]=Array(9).fill(!1),{...e,board:s,notes:o}}),this.gameComplete.set(!1)}undo(){const e=this.stateHistoryStack.pop();e&&(this.state.set({...e,selectedCell:nt(e,j(this.state))}),this.canUndo.set(this.stateHistoryStack.length>0))}isInitial(e,l){return this.initialBoard[e][l]!==0}isSameBox(e,l){const t=j(this.selectedCell);if(!t||t.row===-1||t.col===-1)return!1;const s=Math.floor(e/3),o=Math.floor(l/3),n=Math.floor(t.row/3),u=Math.floor(t.col/3);return s===n&&o===u}hasSameValue(e,l){const t=j(this.selectedCell),s=j(this.board);if(!t||!s||t.row===-1||t.col===-1)return!1;const o=s[t.row][t.col];return!!(o&&s[e][l]===o)}isEditableCell(e,l){return e===-1||l===-1?!1:this.initialBoard[e][l]===0}updateCompleteState(){const e=j(this.board);if(!e.every(s=>s.every(o=>o>0))){this.gameComplete.set(!1);return}if(be(e).length>0){this.gameComplete.set(!1);return}this.gameComplete.set(!0)}updateState(e){this.state.update(l=>{const t=e(l),s=j(this.timeStart),o=j(this.timePass)+(Date.now()-s)/1e3;return ve.saveCurrentGame(this.initialBoard,t,o),ne(l.board,t.board)&&ne(l.notes,t.notes)||(this.stateHistoryStack.push(l),this.canUndo.set(!0)),t})}}var ut=A('<div class="overlay svelte-m821eu"><div class="complete-card svelte-m821eu"><h2 class="svelte-m821eu">Puzzle Completed!</h2> <p class="svelte-m821eu"> </p> <button class="new-game-btn svelte-m821eu">New Game</button></div></div>');function dt(a,e){z(e,!1);let l=P(e,"levelId",8);function t(){pe(F("/"))}q();var s=ut();Se(i=>{L(()=>Ce.title=`Sudoku 1024: ${$[l()].name??""} Complete`)});var o=w(s),n=G(w(o),2),u=w(n);b(n);var r=G(n,2);b(o),b(s),L(()=>W(u,`Congratulations! You've successfully completed the ${$[l()].name??""} puzzle.`)),T("click",r,t),y(a,s),O()}var vt=A('<div class="header svelte-1fp9g2h"><button class="back-btn svelte-1fp9g2h">Back</button> <div class="title svelte-1fp9g2h"><h1 class="svelte-1fp9g2h"> </h1> <h2 class="svelte-1fp9g2h"> </h2></div> <button class="clear-btn svelte-1fp9g2h">Reset</button></div>');function ft(a,e){z(e,!1);const l=_();let t=P(e,"levelId",8);const s=te();let o=_(0),n=!1;function u(){pe(F("/"))}function r(){s.clearBoard()}Y(()=>{const U=setInterval(()=>{n||Ue(o)},1e3),D=s.timePass.subscribe(v=>{S(o,v)}),x=s.gameComplete.subscribe(v=>{n=v});return()=>{clearInterval(U),D(),x()}}),ee(()=>c(o),()=>{S(l,new Date(c(o)*1e3).toISOString().substr(11,8))}),ie(),q();var i=vt(),k=w(i),f=G(k,2),p=w(f),M=w(p,!0);b(p);var g=G(p,2),h=w(g,!0);b(g),b(f);var B=G(f,2);b(i),L(()=>{W(M,$[t()].name),W(h,c(l))}),T("click",k,u),T("click",B,r),y(a,i),O()}var bt=A('<div><!> <div><div><!></div> <div class="controls-container svelte-1lbps5s"><!></div></div> <!></div>');function ht(a,e){z(e,!1);const l=_();let t=P(e,"levelId",8),s=P(e,"initialBoard",8);const o=new ct;o.init(t(),s()),Re(o);let n=_(!1),u=_(!1),r=_(0),i=_(0);Y(()=>{const d=o.gameComplete.subscribe(E=>{S(n,E)});return()=>{d()}});function k(d){if(!c(n))if(d.key.match(/[1-9]/)){const E=parseInt(d.key,10);o.enterDigit(E)}else d.key==="Backspace"?o.clearSelectedCell():d.key==="Enter"||d.key===" "?o.toggleNoteMode():d.key==="ArrowUp"?f(-1,0):d.key==="ArrowDown"?f(1,0):d.key==="ArrowLeft"?f(0,-1):d.key==="ArrowRight"?f(0,1):d.key==="z"&&(d.ctrlKey||d.metaKey)&&o.undo()}function f(d,E){const m=j(o.selectedCell);m.row===-1||m.col===-1?(m.row=0,m.col=0):(m.row+=d,m.col+=E),m.row<0&&(m.row=8),m.row>8&&(m.row=0),m.col<0&&(m.col=8),m.col>8&&(m.col=0),o.selectCell(m.row,m.col)}ee(()=>(c(r),c(i)),()=>{S(u,c(r)>c(i)||c(r)>650)}),ee(()=>(c(i),c(u),c(r)),()=>{S(l,c(i)>0&&!c(u)&&c(r)/c(i)>.65)}),ie(),q();var p=bt();T("keydown",De,k);let M;var g=w(p);ft(g,{get levelId(){return t()}});var h=G(g,2);let B;var U=w(h);let D;var x=w(U);Xe(x,{}),b(U);var v=G(U,2),C=w(v);at(C,{}),b(v),b(h);var N=G(h,2);{var V=d=>{dt(d,{get levelId(){return t()}})};re(N,d=>{c(n)&&d(V)})}b(p),L((d,E,m)=>{M=R(p,1,"container svelte-1lbps5s",null,M,d),B=R(h,1,"game-content svelte-1lbps5s",null,B,E),D=R(U,1,"board-container svelte-1lbps5s",null,D,m)},[()=>({"wide-layout":c(u)}),()=>({"wide-layout":c(u)}),()=>({"square-layout":c(l)})],H),de("innerWidth",d=>S(r,d)),de("innerHeight",d=>S(i,d)),y(a,p),O()}var mt=A("<!> <!>",1);function Nt(a,e){z(e,!1);let l=P(e,"data",8);q();var t=mt();Se(n=>{L(()=>Ce.title=`Sudoku 1024: ${$[l().levelId].name??""}`)});var s=we(t);ht(s,{get levelId(){return l().levelId},get initialBoard(){return l().board}});var o=G(s,2);xe(o,{isVisible:!1}),y(a,t),O()}export{Nt as component,It as universal};
