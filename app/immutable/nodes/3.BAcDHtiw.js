var he=Object.defineProperty;var ge=(n,e,o)=>e in n?he(n,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):n[e]=o;var I=(n,e,o)=>ge(n,typeof e!="symbol"?e+"":e,o);import{a as me,b as Ce,g as we,e as te,i as le}from"../chunks/BOB4IByH.js";import{R as pe,w as ne,d as T,g as ve,b as fe}from"../chunks/CZarZpFs.js";import{t as A,a as k,c as _e,n as ye}from"../chunks/C__5v9kr.js";import{i as U}from"../chunks/Dj8PqmZs.js";import{o as ce,aC as ke,aD as Me,s as j,aE as J,F as S,aF as y,f as ae,aG as ie,w,x as h,t as F,X as O,g as i,v as K,q as Se,y as N,z as Be,aH as Ve,aI as Ae,aJ as G}from"../chunks/DYrX2ids.js";import{p as _,i as ee}from"../chunks/Dr2BO5k9.js";import{l as Ie,w as xe,e as H,s as Q}from"../chunks/DtG3s25q.js";import{o as oe}from"../chunks/BiPqryrm.js";function q(n,e,o,t,l,s){var c=n.__className;if(ce||c!==o){var d=me(o,t,s);(!ce||d!==n.getAttribute("class"))&&(d==null?n.removeAttribute("class"):n.className=d),n.__className=o}else if(s&&l!==s)for(var a in s){var r=!!s[a];(l==null||r!==!!l[a])&&n.classList.toggle(a,r)}return s}function de(n,e){Ie(window,["resize"],()=>xe(()=>e(window[n])))}function ue(n,e){throw new pe(n,e.toString())}new TextEncoder;const Ne=({url:n})=>{const e=n.searchParams.get("level");if(!e)throw ue(303,"/");let o=n.searchParams.get("board");const t=o?Ce(o):null;if(!t)throw o=we(e),ue(303,`play?level=${e}&board=${o}`);return{levelId:e,board:t}},vt=Object.freeze(Object.defineProperty({__proto__:null,load:Ne},Symbol.toStringTag,{value:"Module"})),be=Symbol("sudoku-view-model");function ze(n){ke(be,n)}function se(){return Me(be)}var Ee=A('<span class="cell-value svelte-cb57pm"> </span>'),De=A('<span class="note-value svelte-cb57pm"></span>'),Pe=A('<div class="note-cell svelte-cb57pm"><!></div>'),Te=A('<div class="notes-grid svelte-cb57pm"></div>'),Re=A("<div><!></div>");function Ge(n,e){j(e,!1);const o=y();let t=_(e,"rowIndex",8),l=_(e,"colIndex",8),s=_(e,"cellValue",8),c=_(e,"isInitial",8),d=_(e,"notes",8),a=_(e,"selectedCell",8),r=_(e,"valueCounts",8),b=_(e,"violatedCells",8);const v=se();function m(u,C){return v.isSameBox(u,C)}function g(u,C){return v.hasSameValue(u,C)}J(()=>(ae(b()),ae(t()),ae(l())),()=>{S(o,b().some(u=>u.row===t()&&u.col===l()))}),ie(),U();var p=Re();let B;var M=w(p);{var V=u=>{var C=Ee(),x=w(C,!0);h(C),F(()=>Q(x,s())),k(u,C)},E=u=>{var C=_e(),x=Se(C);{var L=R=>{var z=Te();te(z,4,()=>Array(9).fill(null),le,(W,re,Z)=>{var f=Pe(),D=w(f);{var X=Y=>{var $=De();$.textContent=Z+1,k(Y,$)};ee(D,Y=>{d()[Z]&&Y(X)})}h(f),k(W,f)}),h(z),k(R,z)};ee(x,R=>{d().some(z=>z)&&R(L)})}k(u,C)};ee(M,u=>{s()?u(V):u(E,!1)})}h(p),F(u=>B=q(p,1,"cell svelte-cb57pm",null,B,u),[()=>({selected:a().row===t()&&a().col===l(),"same-line":a().row===t()||a().col===l(),"same-box":m(t(),l())&&!(a().row===t()&&a().col===l()),"same-value":g(t(),l())&&!(a().row===t()&&a().col===l()),complete:s()&&r()[s()]>=9,violated:i(o),initial:c()})],O),H("click",p,()=>v.selectCell(t(),l())),k(n,p),K()}var He=A("<div><!></div>"),Le=A('<div class="row svelte-cpzb4l"></div>'),Oe=A('<div class="sudoku-board svelte-cpzb4l"></div>');function qe(n,e){j(e,!1);let o=_(e,"board",24,()=>[]),t=_(e,"notes",24,()=>[]),l=_(e,"selectedCell",24,()=>({row:-1,col:-1}));const s=se();let c=y([]),d=y([]);oe(()=>{const r=s.valueCounts.subscribe(v=>{S(c,v)}),b=s.violatedCells.subscribe(v=>{S(d,v)});return()=>{r(),b()}}),U();var a=Oe();te(a,5,o,le,(r,b,v)=>{var m=Le();te(m,5,()=>i(b),le,(g,p,B)=>{var M=He();q(M,1,"cell svelte-cpzb4l",null,{},{"border-bottom-thick":v%3===2&&v<8,"border-right-thick":B%3===2&&B<8});var V=w(M);const E=O(()=>s.initialBoard[v][B]!==0);Ge(V,{rowIndex:v,colIndex:B,get cellValue(){return i(p)},get isInitial(){return i(E)},get notes(){return t()[v][B]},get selectedCell(){return l()},get valueCounts(){return i(c)},get violatedCells(){return i(d)}}),h(M),k(g,M)}),h(m),k(r,m)}),h(a),k(n,a),K()}var Fe=ye('<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path></svg>');function Ue(n){var e=Fe();k(n,e)}var je=A('<div class="tip svelte-1h2zn7p">Tip: Select a cell and press 1-9 to enter values. Use note mode for candidates.</div>');function Ke(n){var e=je();k(n,e)}var We=A("<button> </button>"),Xe=A('<div class="container svelte-o19vvk"><div class="digits-container svelte-o19vvk"><!> <button class="digit-button clear-btn svelte-o19vvk"><span>&#10005;</span></button></div> <div class="actions-container svelte-o19vvk"><button><!> <span>Note</span></button></div> <!></div>');function Ye(n,e){j(e,!1);let o=_(e,"digitCounts",24,()=>Array(9).fill(0)),t=y(!1),l=y(!0);const s=se();function c(V){s.enterDigit(V)}function d(){s.toggleNoteMode()}oe(()=>{const V=s.noteMode.subscribe(u=>{S(t,u)}),E=s.cellEditable.subscribe(u=>{S(l,u)});return()=>{V(),E()}}),U();var a=Xe(),r=w(a),b=w(r);te(b,0,()=>Array(9).fill(null),le,(V,E,u)=>{var C=We();const x=O(()=>u+1),L=O(()=>o()[u]);let R;var z=w(C,!0);h(C),F(W=>{R=q(C,1,"digit-button svelte-o19vvk",null,R,W),C.disabled=i(L)>=9,Q(z,i(x))},[()=>({disabled:i(L)>=9})],O),H("click",C,()=>c(i(x))),k(V,C)});var v=N(b,2);h(r);var m=N(r,2),g=w(m);let p;var B=w(g);Ue(B),Be(2),h(g),h(m);var M=N(m,2);Ke(M),h(a),F(V=>{v.disabled=!i(l),p=q(g,1,"action-button note-btn svelte-o19vvk",null,p,V)},[()=>({active:i(t)})],O),H("click",v,()=>s.clearSelectedCell()),H("click",g,d),k(n,a),K()}class Je{constructor(e,o){I(this,"state");I(this,"board");I(this,"notes");I(this,"selectedCell");I(this,"noteMode");I(this,"levelId");I(this,"digitCounts");I(this,"valueCounts");I(this,"cellEditable");I(this,"violatedCells");I(this,"gameComplete");this.initialBoard=o,this.state=ne({initialBoard:o,board:o,notes:Array(9).fill(null).map(()=>Array(9).fill(null).map(()=>Array(9).fill(!1))),selectedCell:{row:-1,col:-1},noteMode:!1,levelId:e}),this.board=T(this.state,t=>t.board),this.notes=T(this.state,t=>t.notes),this.selectedCell=T(this.state,t=>t.selectedCell),this.noteMode=T(this.state,t=>t.noteMode),this.levelId=T(this.state,t=>t.levelId),this.digitCounts=T(this.board,t=>this.calculateDigitCounts(t)),this.valueCounts=T(this.board,t=>this.calculateValueCounts(t)),this.cellEditable=T(this.selectedCell,t=>this.isEditableCell(t.row,t.col)),this.violatedCells=T(this.board,t=>this.findViolatedCells(t)),this.gameComplete=ne(!1)}clearBoard(){this.state.update(e=>({...e,board:e.initialBoard,notes:Array(9).fill(null).map(()=>Array(9).fill(null).map(()=>Array(9).fill(!1))),selectedCell:{row:-1,col:-1},noteMode:!1})),this.gameComplete.set(!1)}selectCell(e,o){this.state.update(t=>({...t,selectedCell:{row:e,col:o}}))}toggleNoteMode(){this.state.update(e=>({...e,noteMode:!e.noteMode}))}enterDigit(e){this.state.update(o=>{const{row:t,col:l}=o.selectedCell;if(!this.isEditableCell(t,l))return o;const s=[...o.board.map(d=>[...d])],c=[...o.notes.map(d=>[...d.map(a=>[...a])])];return o.noteMode?c[t][l][e-1]=!c[t][l][e-1]:s[t][l]=e,{...o,board:s,notes:c}}),this.updateCompleteState()}clearSelectedCell(){this.state.update(e=>{const{row:o,col:t}=e.selectedCell;if(!this.isEditableCell(o,t))return e;const l=[...e.board.map(c=>[...c])],s=[...e.notes.map(c=>[...c.map(d=>[...d])])];return l[o][t]!==0?l[o][t]=0:s[o][t]=Array(9).fill(!1),{...e,board:l,notes:s}}),this.gameComplete.set(!1)}calculateDigitCounts(e){const o=Array(9).fill(0);for(let t=0;t<9;t++)for(let l=0;l<9;l++)e[t][l]>0&&o[e[t][l]-1]++;return o}calculateValueCounts(e){const o=Array(10).fill(0);for(let t=0;t<9;t++)for(let l=0;l<9;l++)e[t][l]&&o[e[t][l]]++;return o}isSameBox(e,o){let t;if(this.selectedCell.subscribe(r=>{t=r})(),!t||t.row===-1||t.col===-1)return!1;const s=Math.floor(e/3),c=Math.floor(o/3),d=Math.floor(t.row/3),a=Math.floor(t.col/3);return s===d&&c===a}hasSameValue(e,o){let t,l;if(this.selectedCell.subscribe(a=>{t=a})(),this.board.subscribe(a=>{l=a})(),!t||!l||t.row===-1||t.col===-1)return!1;const d=l[t.row][t.col];return!!(d&&l[e][o]===d)}isEditableCell(e,o){return e===-1||o===-1?!1:this.initialBoard[e][o]===0}findViolatedCells(e){const o=[],t=(l,s)=>o.some(c=>c.row===l&&c.col===s);for(let l=0;l<9;l++)for(let s=0;s<9;s++){const c=e[l][s];if(!c||t(l,s))continue;for(let r=0;r<9;r++)r!==s&&e[l][r]===c&&(t(l,s)||o.push({row:l,col:s}),t(l,r)||o.push({row:l,col:r}));for(let r=0;r<9;r++)r!==l&&e[r][s]===c&&(t(l,s)||o.push({row:l,col:s}),t(r,s)||o.push({row:r,col:s}));const d=Math.floor(l/3)*3,a=Math.floor(s/3)*3;for(let r=d;r<d+3;r++)for(let b=a;b<a+3;b++)(r!==l||b!==s)&&e[r][b]===c&&(t(l,s)||o.push({row:l,col:s}),t(r,b)||o.push({row:r,col:b}))}return o}updateCompleteState(){let e;if(this.board.subscribe(s=>{e=s})(),!e)return;if(!e.every(s=>s.every(c=>c>0))){this.gameComplete.set(!1);return}if(this.findViolatedCells(e).length>0){this.gameComplete.set(!1);return}this.gameComplete.set(!0)}}var Qe=A('<div class="overlay svelte-e4go0s"><div class="complete-card svelte-e4go0s"><h2 class="svelte-e4go0s">Puzzle Completed!</h2> <p class="svelte-e4go0s"> </p> <button class="new-game-btn svelte-e4go0s">New Game</button></div></div>');function Ze(n,e){j(e,!1);let o=_(e,"levelId",8);function t(){ve(`${fe}/`)}U();var l=Qe(),s=w(l),c=N(w(s),2),d=w(c);h(c);var a=N(c,2);h(s),h(l),F(()=>Q(d,`Congratulations! You've successfully completed the ${o()??""} puzzle.`)),H("click",a,t),k(n,l),K()}var $e=A('<div class="header svelte-1o91g5p"><button class="back-btn svelte-1o91g5p">Back</button> <div class="title svelte-1o91g5p"><h1 class="svelte-1o91g5p"> </h1> <h2 class="svelte-1o91g5p"> </h2></div> <button class="clear-btn svelte-1o91g5p">Clear</button></div>');function et(n,e){j(e,!1);const o=y();let t=_(e,"levelId",8),l=y(0);const s=se();function c(){ve(`${fe}/`)}function d(){s.clearBoard()}oe(()=>{const M=setInterval(()=>{Ve(l)},1e3);return()=>{clearInterval(M)}}),J(()=>i(l),()=>{S(o,new Date(i(l)*1e3).toISOString().substr(11,8))}),ie(),U();var a=$e(),r=w(a),b=N(r,2),v=w(b),m=w(v,!0);h(v);var g=N(v,2),p=w(g,!0);h(g),h(b);var B=N(b,2);h(a),F(()=>{Q(m,t()),Q(p,i(o))}),H("click",r,c),H("click",B,d),k(n,a),K()}var tt=A('<div><!> <div><div><!></div> <div class="controls-container svelte-1lnc43"><!></div></div> <!></div>');function lt(n,e){j(e,!1);const o=y();let t=_(e,"levelId",8),l=_(e,"initialBoard",8);const s=new Je(t(),l());ze(s);let c=y([]),d=y([]),a=y({row:-1,col:-1}),r=y(Array(9).fill(0)),b=y(!1),v=y(!1),m=y(0),g=y(0);oe(()=>{const f=s.board.subscribe(P=>{S(c,P)}),D=s.notes.subscribe(P=>{S(d,P)}),X=s.selectedCell.subscribe(P=>{S(a,P)}),Y=s.digitCounts.subscribe(P=>{S(r,P)}),$=s.gameComplete.subscribe(P=>{S(b,P)});return()=>{f(),D(),X(),Y(),$()}});function p(f,D){i(a).row===-1||i(a).col===-1?(G(a,i(a).row=0),G(a,i(a).col=0)):(G(a,i(a).row+=f),G(a,i(a).col+=D)),i(a).row<0&&G(a,i(a).row=0),i(a).row>8&&G(a,i(a).row=8),i(a).col<0&&G(a,i(a).col=0),i(a).col>8&&G(a,i(a).col=8),s.selectCell(i(a).row,i(a).col)}function B(f){if(!i(b))if(f.key.match(/[1-9]/)){const D=parseInt(f.key,10);s.enterDigit(D)}else f.key==="Backspace"?s.clearSelectedCell():f.key==="Enter"?s.toggleNoteMode():f.key==="ArrowUp"?p(-1,0):f.key==="ArrowDown"?p(1,0):f.key==="ArrowLeft"?p(0,-1):f.key==="ArrowRight"&&p(0,1)}J(()=>(i(m),i(g)),()=>{S(v,i(m)>i(g))}),J(()=>(i(g),i(v),i(m)),()=>{S(o,i(g)>0&&!i(v)&&i(m)/i(g)>.65)}),J(()=>(i(m),i(g)),()=>{console.log(i(m),i(g),i(m)>i(g),i(m)/i(g))}),ie(),U();var M=tt();H("keydown",Ae,B);let V;var E=w(M);et(E,{get levelId(){return t()}});var u=N(E,2);let C;var x=w(u);let L;var R=w(x);qe(R,{get board(){return i(c)},get notes(){return i(d)},get selectedCell(){return i(a)}}),h(x);var z=N(x,2),W=w(z);Ye(W,{get digitCounts(){return i(r)}}),h(z),h(u);var re=N(u,2);{var Z=f=>{Ze(f,{get levelId(){return t()}})};ee(re,f=>{i(b)&&f(Z)})}h(M),F((f,D,X)=>{V=q(M,1,"container svelte-1lnc43",null,V,f),C=q(u,1,"game-content svelte-1lnc43",null,C,D),L=q(x,1,"board-container svelte-1lnc43",null,L,X)},[()=>({"wide-layout":i(v)}),()=>({"wide-layout":i(v)}),()=>({"square-layout":i(o)})],O),de("innerWidth",f=>S(m,f)),de("innerHeight",f=>S(g,f)),k(n,M),K()}function ft(n,e){j(e,!1);let o=_(e,"data",8);U(),lt(n,{get levelId(){return o().levelId},get initialBoard(){return o().board}}),K()}export{ft as component,vt as universal};
