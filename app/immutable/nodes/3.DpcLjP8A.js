var ye=Object.defineProperty;var ke=(a,e,l)=>e in a?ye(a,e,{enumerable:!0,configurable:!0,writable:!0,value:l}):a[e]=l;var I=(a,e,l)=>ke(a,typeof e!="symbol"?e+"":e,l);import{b as Me,d as Be,g as Ie,a as W,e as Q,i as Z,c as Ae,f as he,L as $,D as Ne}from"../chunks/Coj1ipSk.js";import{R as xe,w as K,d as J,g as me}from"../chunks/CdP8HIOC.js";import{t as N,a as S,c as Ve,n as ge}from"../chunks/DqXwdAxK.js";import"../chunks/BfK0U9aN.js";import{j as ie,aH as Ee,aI as je,p as z,aJ as ee,A as _,aG as y,e as oe,aK as ne,o as p,q as h,t as L,V as H,g as c,n as O,m as pe,s as V,v as ce,$ as we,aL as Pe,aM as Ge}from"../chunks/D4frfRg2.js";import{l as Ue,w as De,e as T,s as Y,h as Ce}from"../chunks/DzLTvIni.js";import{i as q}from"../chunks/DQpucoam.js";import{p as x,i as ae}from"../chunks/jNJZQ3UP.js";import{o as te}from"../chunks/CxcJMqRD.js";function R(a,e,l,t,s,o){var n=a.__className;if(ie||n!==l){var u=Me(l,t,o);(!ie||u!==a.getAttribute("class"))&&(u==null?a.removeAttribute("class"):a.className=u),a.__className=l}else if(o&&s!==o)for(var r in o){var i=!!o[r];(s==null||i!==!!s[r])&&a.classList.toggle(r,i)}return o}function ue(a,e){Ue(window,["resize"],()=>De(()=>e(window[a])))}function Te(a){const e=Be(a);if(e===null||e.length!==81)return null;const l=[];for(let t=0;t<9;t++){const s=[];for(let o=0;o<9;o++)s.push(e[t*9+o]);l.push(s)}return l}function X(a,e){throw new xe(a,e.toString())}new TextEncoder;const Le=({url:a})=>{const e=a.searchParams.get("game");if(!e)throw X(303,W("/"));const l=parseInt(e[0]);if(isNaN(l)||l<1||l>4)throw X(303,W("/"));const t=l;if(!t)throw X(303,W("/"));let s=e.substring(1);const o=s?Te(s):null;if(!o)throw s=Ie.generateBoardString(t),X(303,`play?game=${l}${s}`);return{levelId:t,board:o}},Bt=Object.freeze(Object.defineProperty({__proto__:null,load:Le},Symbol.toStringTag,{value:"Module"})),Se=Symbol("sudoku-view-model");function He(a){Ee(Se,a)}function le(){return je(Se)}var Re=N('<span class="cell-value svelte-9jn413"> </span>'),ze=N('<div class="note-cell svelte-9jn413"><span class="note-value svelte-9jn413"></span></div>'),Oe=N('<div class="notes-grid svelte-9jn413"></div>'),qe=N("<div><!></div>");function Ke(a,e){z(e,!1);const l=y();let t=x(e,"rowIndex",8),s=x(e,"colIndex",8),o=x(e,"cellValue",8),n=x(e,"isInitial",8),u=x(e,"notes",8),r=x(e,"selectedCell",8),i=x(e,"valueCounts",8),k=x(e,"violatedCells",8);const f=le();function w(v,g){return f.isSameBox(v,g)}function M(v,g){return f.hasSameValue(v,g)}ee(()=>(oe(k()),oe(t()),oe(s())),()=>{_(l,k().some(v=>v.row===t()&&v.col===s()))}),ne(),q();var b=qe();let C;var A=p(b);{var E=v=>{var g=Re(),U=p(g,!0);h(g),L(()=>Y(U,o())),S(v,g)},G=v=>{var g=Oe();Q(g,4,()=>Array(9).fill(null),Z,(U,P,B)=>{var d=Ve(),j=pe(d);{var m=F=>{var se=ze(),_e=p(se);_e.textContent=B+1,h(se),S(F,se)};ae(j,F=>{u()[B]&&F(m)})}S(U,d)}),h(g),S(v,g)};ae(A,v=>{o()?v(E):v(G,!1)})}h(b),L(v=>C=R(b,1,"cell svelte-9jn413",null,C,v),[()=>({selected:r().row===t()&&r().col===s(),"same-line":r().row===t()||r().col===s(),"same-box":w(t(),s())&&!(r().row===t()&&r().col===s()),"same-value":M(t(),s())&&!(r().row===t()&&r().col===s()),complete:o()&&i()[o()]>=9,violated:c(l),initial:n()})],H),T("click",b,()=>f.selectCell(t(),s())),S(a,b),O()}var Je=N("<div><!></div>"),Fe=N('<div class="row svelte-41cq0t"></div>'),We=N('<div class="sudoku-board svelte-41cq0t"></div>');function Ye(a,e){z(e,!1);let l=y([]),t=y([]),s=y({row:-1,col:-1});const o=le();let n=y([]),u=y([]);te(()=>{const i=o.board.subscribe(b=>{_(l,b)}),k=o.notes.subscribe(b=>{_(t,b)}),f=o.selectedCell.subscribe(b=>{_(s,b)}),w=o.valueCounts.subscribe(b=>{_(n,b)}),M=o.violatedCells.subscribe(b=>{_(u,b)});return()=>{i(),k(),f(),w(),M()}}),q();var r=We();Q(r,5,()=>c(l),Z,(i,k,f)=>{var w=Fe();Q(w,5,()=>c(k),Z,(M,b,C)=>{var A=Je();R(A,1,"cell svelte-41cq0t",null,{},{"border-bottom-thick":f%3===2&&f<8,"border-right-thick":C%3===2&&C<8});var E=p(A);const G=H(()=>o.isInitial(f,C));Ke(E,{rowIndex:f,colIndex:C,get cellValue(){return c(b)},get isInitial(){return c(G)},get notes(){return c(t)[f][C]},get selectedCell(){return c(s)},get valueCounts(){return c(n)},get violatedCells(){return c(u)}}),h(A),S(M,A)}),h(w),S(i,w)}),h(r),S(a,r),O()}var Xe=ge('<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path></svg>');function Qe(a){var e=Xe();S(a,e)}var Ze=N('<div class="container svelte-1kf9c29"><p class="tip svelte-1kf9c29">Tip: Select a cell and press 1-9 to enter values. Use note mode for candidates.</p> <p class="tip svelte-1kf9c29">Any issue or suggestion? <br>Please report on <a href="https://github.com/tuanchauict/sudoku-1024/" target="_blank" class="svelte-1kf9c29">GitHub</a> of the project.</p></div>');function $e(a){var e=Ze();S(a,e)}var et=ge('<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" stroke="none" viewBox="0 0 24 24"><path d="M12.5 8c-2.65 0-5.05.99-6.9 2.6L2 7v9h9l-3.62-3.62c1.39-1.16 3.16-1.88 5.12-1.88 3.54 0 6.55 2.31 7.6 5.5l2.37-.78C21.08 11.03 17.15 8 12.5 8z"></path></svg>');function tt(a){var e=et();S(a,e)}var lt=N('<button tabindex="-1"> </button>'),st=N('<div class="container svelte-84d01j"><div class="digits-container svelte-84d01j"><!> <button class="btn clear-btn svelte-84d01j" tabindex="-1"><span>&#10005;</span></button></div> <div class="actions-container svelte-84d01j"><button class="btn action-button svelte-84d01j" tabindex="-1"><!> <span>Undo</span></button> <button tabindex="-1"><!> <span>Note</span></button></div> <!></div>');function ot(a,e){z(e,!1);let l=y(Array(10).fill(0)),t=y(!1),s=y(!0),o=y(!1);const n=le();function u(v){n.enterDigit(v)}te(()=>{const v=n.noteMode.subscribe(B=>{_(t,B)}),g=n.cellEditable.subscribe(B=>{_(s,B)}),U=n.canUndo.subscribe(B=>{_(o,B)}),P=n.valueCounts.subscribe(B=>{_(l,B)});return()=>{v(),g(),U(),P()}}),q();var r=st(),i=p(r),k=p(i);Q(k,0,()=>Array(9).fill(null),Z,(v,g,U)=>{var P=lt();const B=H(()=>U+1),d=H(()=>c(l)[U+1]);let j;var m=p(P,!0);h(P),L(F=>{j=R(P,1,"btn digit-button svelte-84d01j",null,j,F),P.disabled=c(d)>=9,Y(m,c(B))},[()=>({disabled:c(d)>=9})],H),T("click",P,()=>u(c(B))),S(v,P)});var f=V(k,2);h(i);var w=V(i,2),M=p(w),b=p(M);tt(b),ce(2),h(M);var C=V(M,2);let A;var E=p(C);Qe(E),ce(2),h(C),h(w);var G=V(w,2);$e(G),h(r),L(v=>{f.disabled=!c(s),M.disabled=!c(o),A=R(C,1,"btn action-button note-btn svelte-84d01j",null,A,v)},[()=>({active:c(t)})],H),T("click",f,()=>n.clearSelectedCell()),T("click",M,()=>n.undo()),T("click",C,()=>n.toggleNoteMode()),S(a,r),O()}const at="sudoku";class de{static saveCurrentGame(e,l,t){const s={state:l,timePass:t};localStorage.setItem(ve(e),JSON.stringify(s))}static loadCurrentGame(e){const l=localStorage.getItem(ve(e));if(!l)return null;const t=JSON.parse(l);return t.state?t:null}}function ve(a){const e=a.flatMap(l=>l);return`${at}_${Ae(e)}`}function re(a,e){return JSON.stringify(a)===JSON.stringify(e)}function D(a){let e;return a.subscribe(t=>{e=t})(),e}function fe(a){const e=[],l=(t,s)=>e.some(o=>o.row===t&&o.col===s);for(let t=0;t<9;t++)for(let s=0;s<9;s++){const o=a[t][s];if(!o||l(t,s))continue;for(let r=0;r<9;r++)r!==s&&a[t][r]===o&&(l(t,s)||e.push({row:t,col:s}),l(t,r)||e.push({row:t,col:r}));for(let r=0;r<9;r++)r!==t&&a[r][s]===o&&(l(t,s)||e.push({row:t,col:s}),l(r,s)||e.push({row:r,col:s}));const n=Math.floor(t/3)*3,u=Math.floor(s/3)*3;for(let r=n;r<n+3;r++)for(let i=u;i<u+3;i++)(r!==t||i!==s)&&a[r][i]===o&&(l(t,s)||e.push({row:t,col:s}),l(r,i)||e.push({row:r,col:i}))}return e}function rt(a,e){for(let l=0;l<9;l++)for(let t=0;t<9;t++)if(e.board[l][t]!==a.board[l][t])return{row:l,col:t};for(let l=0;l<9;l++)for(let t=0;t<9;t++)if(!re(e.notes[l][t],a.notes[l][t]))return{row:l,col:t};return{row:0,col:0}}function nt(a){const e=Array(10).fill(0);for(let l=0;l<9;l++)for(let t=0;t<9;t++)a[l][t]&&e[a[l][t]]++;return e}const be=he(0,Array(9).fill(Array(9).fill(0)));class it{constructor(){I(this,"initialBoard",be.initialBoard);I(this,"state",K(be));I(this,"stateHistoryStack",[]);I(this,"board");I(this,"notes");I(this,"selectedCell");I(this,"noteMode",K(!1));I(this,"valueCounts");I(this,"cellEditable");I(this,"violatedCells");I(this,"gameComplete",K(!1));I(this,"timePass",K(0));I(this,"timeStart",K(Date.now()));I(this,"canUndo",K(!1));this.board=J(this.state,e=>e.board),this.notes=J(this.state,e=>e.notes),this.selectedCell=J(this.state,e=>e.selectedCell),this.valueCounts=J(this.board,e=>nt(e)),this.cellEditable=J(this.selectedCell,e=>this.isEditableCell(e.row,e.col)),this.violatedCells=J(this.board,e=>fe(e))}init(e,l){const t=de.loadCurrentGame(l),s=t?t.state:he(e,l);this.state.set(s),this.initialBoard=l,this.stateHistoryStack.length=0,this.timePass.set(t?t.timePass:0),this.timeStart.set(Date.now())}get isInNodeMode(){return D(this.noteMode)}clearBoard(){this.updateState(e=>({...e,board:this.initialBoard,notes:Array(9).fill(null).map(()=>Array(9).fill(null).map(()=>Array(9).fill(!1))),noteMode:!1})),this.gameComplete.set(!1)}selectCell(e,l){this.updateState(t=>({...t,selectedCell:{row:e,col:l}}))}toggleNoteMode(){this.noteMode.set(!this.isInNodeMode)}enterDigit(e){this.updateState(l=>{const{row:t,col:s}=l.selectedCell;if(!this.isEditableCell(t,s))return l;const o=[...l.board.map(u=>[...u])],n=[...l.notes.map(u=>[...u.map(r=>[...r])])];if(this.isInNodeMode)n[t][s][e-1]=!n[t][s][e-1];else{o[t][s]=e;const u=Math.floor(t/3)*3,r=Math.floor(s/3)*3;for(let i=0;i<9;i++){n[t][i][e-1]=!1,n[i][s][e-1]=!1;const k=u+Math.floor(i/3),f=r+i%3;n[k][f][e-1]=!1}}return{...l,board:o,notes:n}}),this.updateCompleteState()}clearSelectedCell(){this.updateState(e=>{const{row:l,col:t}=e.selectedCell;if(!this.isEditableCell(l,t))return e;const s=[...e.board.map(n=>[...n])],o=[...e.notes.map(n=>[...n.map(u=>[...u])])];return s[l][t]!==0?s[l][t]=0:o[l][t]=Array(9).fill(!1),{...e,board:s,notes:o}}),this.gameComplete.set(!1)}undo(){const e=this.stateHistoryStack.pop();e&&(this.state.set({...e,selectedCell:rt(e,D(this.state))}),this.canUndo.set(this.stateHistoryStack.length>0))}isInitial(e,l){return this.initialBoard[e][l]!==0}isSameBox(e,l){const t=D(this.selectedCell);if(!t||t.row===-1||t.col===-1)return!1;const s=Math.floor(e/3),o=Math.floor(l/3),n=Math.floor(t.row/3),u=Math.floor(t.col/3);return s===n&&o===u}hasSameValue(e,l){const t=D(this.selectedCell),s=D(this.board);if(!t||!s||t.row===-1||t.col===-1)return!1;const o=s[t.row][t.col];return!!(o&&s[e][l]===o)}isEditableCell(e,l){return e===-1||l===-1?!1:this.initialBoard[e][l]===0}updateCompleteState(){const e=D(this.board);if(!e.every(s=>s.every(o=>o>0))){this.gameComplete.set(!1);return}if(fe(e).length>0){this.gameComplete.set(!1);return}this.gameComplete.set(!0)}updateState(e){this.state.update(l=>{const t=e(l),s=D(this.timeStart),o=D(this.timePass)+(Date.now()-s)/1e3;return de.saveCurrentGame(this.initialBoard,t,o),re(l.board,t.board)&&re(l.notes,t.notes)||(this.stateHistoryStack.push(l),this.canUndo.set(!0)),t})}}var ct=N('<div class="overlay svelte-m821eu"><div class="complete-card svelte-m821eu"><h2 class="svelte-m821eu">Puzzle Completed!</h2> <p class="svelte-m821eu"> </p> <button class="new-game-btn svelte-m821eu">New Game</button></div></div>');function ut(a,e){z(e,!1);let l=x(e,"levelId",8);function t(){me(W("/"))}q();var s=ct();Ce(i=>{L(()=>we.title=`Sudoku 1024: ${$[l()].name??""} Complete`)});var o=p(s),n=V(p(o),2),u=p(n);h(n);var r=V(n,2);h(o),h(s),L(()=>Y(u,`Congratulations! You've successfully completed the ${$[l()].name??""} puzzle.`)),T("click",r,t),S(a,s),O()}var dt=N('<div class="header svelte-1fp9g2h"><button class="back-btn svelte-1fp9g2h">Back</button> <div class="title svelte-1fp9g2h"><h1 class="svelte-1fp9g2h"> </h1> <h2 class="svelte-1fp9g2h"> </h2></div> <button class="clear-btn svelte-1fp9g2h">Reset</button></div>');function vt(a,e){z(e,!1);const l=y();let t=x(e,"levelId",8);const s=le();let o=y(0),n=!1;function u(){me(W("/"))}function r(){s.clearBoard()}te(()=>{const E=setInterval(()=>{n||Pe(o)},1e3),G=s.timePass.subscribe(g=>{_(o,g)}),v=s.gameComplete.subscribe(g=>{n=g});return()=>{clearInterval(E),G(),v()}}),ee(()=>c(o),()=>{_(l,new Date(c(o)*1e3).toISOString().substr(11,8))}),ne(),q();var i=dt(),k=p(i),f=V(k,2),w=p(f),M=p(w,!0);h(w);var b=V(w,2),C=p(b,!0);h(b),h(f);var A=V(f,2);h(i),L(()=>{Y(M,$[t()].name),Y(C,c(l))}),T("click",k,u),T("click",A,r),S(a,i),O()}var ft=N('<div><!> <div><div><!></div> <div class="controls-container svelte-1lbps5s"><!></div></div> <!></div>');function bt(a,e){z(e,!1);const l=y();let t=x(e,"levelId",8),s=x(e,"initialBoard",8);const o=new it;o.init(t(),s()),He(o);let n=y(!1),u=y(!1),r=y(0),i=y(0);te(()=>{const d=o.gameComplete.subscribe(j=>{_(n,j)});return()=>{d()}});function k(d){if(!c(n))if(d.key.match(/[1-9]/)){const j=parseInt(d.key,10);o.enterDigit(j)}else d.key==="Backspace"?o.clearSelectedCell():d.key==="Enter"||d.key===" "?o.toggleNoteMode():d.key==="ArrowUp"?f(-1,0):d.key==="ArrowDown"?f(1,0):d.key==="ArrowLeft"?f(0,-1):d.key==="ArrowRight"?f(0,1):d.key==="z"&&(d.ctrlKey||d.metaKey)&&o.undo()}function f(d,j){const m=D(o.selectedCell);m.row===-1||m.col===-1?(m.row=0,m.col=0):(m.row+=d,m.col+=j),m.row<0&&(m.row=8),m.row>8&&(m.row=0),m.col<0&&(m.col=8),m.col>8&&(m.col=0),o.selectCell(m.row,m.col)}ee(()=>(c(r),c(i)),()=>{_(u,c(r)>c(i)||c(r)>650)}),ee(()=>(c(i),c(u),c(r)),()=>{_(l,c(i)>0&&!c(u)&&c(r)/c(i)>.65)}),ne(),q();var w=ft();T("keydown",Ge,k);let M;var b=p(w);vt(b,{get levelId(){return t()}});var C=V(b,2);let A;var E=p(C);let G;var v=p(E);Ye(v,{}),h(E);var g=V(E,2),U=p(g);ot(U,{}),h(g),h(C);var P=V(C,2);{var B=d=>{ut(d,{get levelId(){return t()}})};ae(P,d=>{c(n)&&d(B)})}h(w),L((d,j,m)=>{M=R(w,1,"container svelte-1lbps5s",null,M,d),A=R(C,1,"game-content svelte-1lbps5s",null,A,j),G=R(E,1,"board-container svelte-1lbps5s",null,G,m)},[()=>({"wide-layout":c(u)}),()=>({"wide-layout":c(u)}),()=>({"square-layout":c(l)})],H),ue("innerWidth",d=>_(r,d)),ue("innerHeight",d=>_(i,d)),S(a,w),O()}var ht=N("<!> <!>",1);function It(a,e){z(e,!1);let l=x(e,"data",8);q();var t=ht();Ce(n=>{L(()=>we.title=`Sudoku 1024: ${$[l().levelId].name??""}`)});var s=pe(t);bt(s,{get levelId(){return l().levelId},get initialBoard(){return l().board}});var o=V(s,2);Ne(o,{isVisible:!1}),S(a,t),O()}export{It as component,Bt as universal};
