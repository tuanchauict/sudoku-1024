var ke=Object.defineProperty;var _e=(a,e,l)=>e in a?ke(a,e,{enumerable:!0,configurable:!0,writable:!0,value:l}):a[e]=l;var I=(a,e,l)=>_e(a,typeof e!="symbol"?e+"":e,l);import{b as ye,d as Me,g as Be,a as W,e as Q,i as Z,c as Ie,f as be,L as $}from"../chunks/Bp2XVeyZ.js";import{R as xe,w as K,d as J,g as me}from"../chunks/CS50VDp0.js";import{l as Ae,w as Ne,t as N,e as z,a as M,d as Ve,n as ge}from"../chunks/CYBOIRDU.js";import{i as R}from"../chunks/D2h7i0by.js";import{h as ne,aH as Ee,aI as Pe,x as O,aJ as ee,K as k,ai as _,t as oe,aK as ie,B as g,C as b,z as L,T as H,q as c,A as q,y as Ue,ah as te,D as G,af as ce,ag as pe,aL as Ge,aM as De}from"../chunks/DCjUhcBe.js";import{s as Y,h as we}from"../chunks/ki9Jwg_P.js";import{p as A}from"../chunks/D8GkmtlV.js";import{i as ae}from"../chunks/D1405Ep2.js";function j(a,e,l,t,s,o){var i=a.__className;if(ne||i!==l){var u=ye(l,t,o);(!ne||u!==a.getAttribute("class"))&&(u==null?a.removeAttribute("class"):a.className=u),a.__className=l}else if(o&&s!==o)for(var r in o){var n=!!o[r];(s==null||n!==!!s[r])&&a.classList.toggle(r,n)}return o}function ue(a,e){Ae(window,["resize"],()=>Ne(()=>e(window[a])))}function Te(a){const e=Me(a);if(e===null||e.length!==81)return null;const l=[];for(let t=0;t<9;t++){const s=[];for(let o=0;o<9;o++)s.push(e[t*9+o]);l.push(s)}return l}function X(a,e){throw new xe(a,e.toString())}new TextEncoder;const Le=({url:a})=>{const e=a.searchParams.get("game");if(!e)throw X(303,W("/"));const l=parseInt(e[0]);if(isNaN(l)||l<1||l>4)throw X(303,W("/"));const t=l;if(!t)throw X(303,W("/"));let s=e.substring(1);const o=s?Te(s):null;if(!o)throw s=Be.generateBoardString(t),X(303,`play?game=${l}${s}`);return{levelId:t,board:o}},_t=Object.freeze(Object.defineProperty({__proto__:null,load:Le},Symbol.toStringTag,{value:"Module"})),Ce=Symbol("sudoku-view-model");function ze(a){Ee(Ce,a)}function le(){return Pe(Ce)}var He=N('<span class="cell-value svelte-9jn413"> </span>'),je=N('<div class="note-cell svelte-9jn413"><span class="note-value svelte-9jn413"></span></div>'),Re=N('<div class="notes-grid svelte-9jn413"></div>'),Oe=N("<div><!></div>");function qe(a,e){O(e,!1);const l=_();let t=A(e,"rowIndex",8),s=A(e,"colIndex",8),o=A(e,"cellValue",8),i=A(e,"isInitial",8),u=A(e,"notes",8),r=A(e,"selectedCell",8),n=A(e,"valueCounts",8),y=A(e,"violatedCells",8);const v=le();function w(f,S){return v.isSameBox(f,S)}function C(f,S){return v.hasSameValue(f,S)}ee(()=>(oe(y()),oe(t()),oe(s())),()=>{k(l,y().some(f=>f.row===t()&&f.col===s()))}),ie(),R();var h=Oe();let p;var x=g(h);{var V=f=>{var S=He(),D=g(S,!0);b(S),L(()=>Y(D,o())),M(f,S)},E=f=>{var S=Re();Q(S,4,()=>Array(9).fill(null),Z,(D,U,B)=>{var d=Ve(),P=Ue(d);{var m=F=>{var se=je(),Se=g(se);Se.textContent=B+1,b(se),M(F,se)};ae(P,F=>{u()[B]&&F(m)})}M(D,d)}),b(S),M(f,S)};ae(x,f=>{o()?f(V):f(E,!1)})}b(h),L(f=>p=j(h,1,"cell svelte-9jn413",null,p,f),[()=>({selected:r().row===t()&&r().col===s(),"same-line":r().row===t()||r().col===s(),"same-box":w(t(),s())&&!(r().row===t()&&r().col===s()),"same-value":C(t(),s())&&!(r().row===t()&&r().col===s()),complete:o()&&n()[o()]>=9,violated:c(l),initial:i()})],H),z("click",h,()=>v.selectCell(t(),s())),M(a,h),q()}var Ke=N("<div><!></div>"),Je=N('<div class="row svelte-41cq0t"></div>'),Fe=N('<div class="sudoku-board svelte-41cq0t"></div>');function We(a,e){O(e,!1);let l=_([]),t=_([]),s=_({row:-1,col:-1});const o=le();let i=_([]),u=_([]);te(()=>{const n=o.board.subscribe(h=>{k(l,h)}),y=o.notes.subscribe(h=>{k(t,h)}),v=o.selectedCell.subscribe(h=>{k(s,h)}),w=o.valueCounts.subscribe(h=>{k(i,h)}),C=o.violatedCells.subscribe(h=>{k(u,h)});return()=>{n(),y(),v(),w(),C()}}),R();var r=Fe();Q(r,5,()=>c(l),Z,(n,y,v)=>{var w=Je();Q(w,5,()=>c(y),Z,(C,h,p)=>{var x=Ke();j(x,1,"cell svelte-41cq0t",null,{},{"border-bottom-thick":v%3===2&&v<8,"border-right-thick":p%3===2&&p<8});var V=g(x);const E=H(()=>o.isInitial(v,p));qe(V,{rowIndex:v,colIndex:p,get cellValue(){return c(h)},get isInitial(){return c(E)},get notes(){return c(t)[v][p]},get selectedCell(){return c(s)},get valueCounts(){return c(i)},get violatedCells(){return c(u)}}),b(x),M(C,x)}),b(w),M(n,w)}),b(r),M(a,r),q()}var Ye=ge('<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path></svg>');function Xe(a){var e=Ye();M(a,e)}var Qe=N('<div class="container svelte-1kf9c29"><p class="tip svelte-1kf9c29">Tip: Select a cell and press 1-9 to enter values. Use note mode for candidates.</p> <p class="tip svelte-1kf9c29">Any issue or suggestion? <br>Please report on <a href="https://github.com/tuanchauict/sudoku-1024/" target="_blank" class="svelte-1kf9c29">GitHub</a> of the project.</p></div>');function Ze(a){var e=Qe();M(a,e)}var $e=ge('<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" stroke="none" viewBox="0 0 24 24"><path d="M12.5 8c-2.65 0-5.05.99-6.9 2.6L2 7v9h9l-3.62-3.62c1.39-1.16 3.16-1.88 5.12-1.88 3.54 0 6.55 2.31 7.6 5.5l2.37-.78C21.08 11.03 17.15 8 12.5 8z"></path></svg>');function et(a){var e=$e();M(a,e)}var tt=N("<button> </button>"),lt=N('<div class="container svelte-1a5ihr1"><div class="digits-container svelte-1a5ihr1"><!> <button class="btn clear-btn svelte-1a5ihr1"><span>&#10005;</span></button></div> <div class="actions-container svelte-1a5ihr1"><button class="btn action-button svelte-1a5ihr1"><!> <span>Undo</span></button> <button><!> <span>Note</span></button></div> <!></div>');function st(a,e){O(e,!1);let l=_(Array(10).fill(0)),t=_(!1),s=_(!0),o=_(!1);const i=le();function u(f){i.enterDigit(f)}te(()=>{const f=i.noteMode.subscribe(B=>{k(t,B)}),S=i.cellEditable.subscribe(B=>{k(s,B)}),D=i.canUndo.subscribe(B=>{k(o,B)}),U=i.valueCounts.subscribe(B=>{k(l,B)});return()=>{f(),S(),D(),U()}}),R();var r=lt(),n=g(r),y=g(n);Q(y,0,()=>Array(9).fill(null),Z,(f,S,D)=>{var U=tt();const B=H(()=>D+1),d=H(()=>c(l)[D+1]);let P;var m=g(U,!0);b(U),L(F=>{P=j(U,1,"btn digit-button svelte-1a5ihr1",null,P,F),U.disabled=c(d)>=9,Y(m,c(B))},[()=>({disabled:c(d)>=9})],H),z("click",U,()=>u(c(B))),M(f,U)});var v=G(y,2);b(n);var w=G(n,2),C=g(w),h=g(C);et(h),ce(2),b(C);var p=G(C,2);let x;var V=g(p);Xe(V),ce(2),b(p),b(w);var E=G(w,2);Ze(E),b(r),L(f=>{v.disabled=!c(s),C.disabled=!c(o),x=j(p,1,"btn action-button note-btn svelte-1a5ihr1",null,x,f)},[()=>({active:c(t)})],H),z("click",v,()=>i.clearSelectedCell()),z("click",C,()=>i.undo()),z("click",p,()=>i.toggleNoteMode()),M(a,r),q()}const ot="sudoku";class de{static saveCurrentGame(e,l,t){const s={state:l,timePass:t};localStorage.setItem(ve(e),JSON.stringify(s))}static loadCurrentGame(e){const l=localStorage.getItem(ve(e));if(!l)return null;const t=JSON.parse(l);return t.state?t:null}}function ve(a){const e=a.flatMap(l=>l);return`${ot}_${Ie(e)}`}function re(a,e){return JSON.stringify(a)===JSON.stringify(e)}function T(a){let e;return a.subscribe(t=>{e=t})(),e}function fe(a){const e=[],l=(t,s)=>e.some(o=>o.row===t&&o.col===s);for(let t=0;t<9;t++)for(let s=0;s<9;s++){const o=a[t][s];if(!o||l(t,s))continue;for(let r=0;r<9;r++)r!==s&&a[t][r]===o&&(l(t,s)||e.push({row:t,col:s}),l(t,r)||e.push({row:t,col:r}));for(let r=0;r<9;r++)r!==t&&a[r][s]===o&&(l(t,s)||e.push({row:t,col:s}),l(r,s)||e.push({row:r,col:s}));const i=Math.floor(t/3)*3,u=Math.floor(s/3)*3;for(let r=i;r<i+3;r++)for(let n=u;n<u+3;n++)(r!==t||n!==s)&&a[r][n]===o&&(l(t,s)||e.push({row:t,col:s}),l(r,n)||e.push({row:r,col:n}))}return e}function at(a,e){for(let l=0;l<9;l++)for(let t=0;t<9;t++)if(e.board[l][t]!==a.board[l][t])return{row:l,col:t};for(let l=0;l<9;l++)for(let t=0;t<9;t++)if(!re(e.notes[l][t],a.notes[l][t]))return{row:l,col:t};return{row:0,col:0}}function rt(a){const e=Array(10).fill(0);for(let l=0;l<9;l++)for(let t=0;t<9;t++)a[l][t]&&e[a[l][t]]++;return e}const he=be(0,Array(9).fill(Array(9).fill(0)));class it{constructor(){I(this,"initialBoard",he.initialBoard);I(this,"state",K(he));I(this,"stateHistoryStack",[]);I(this,"board");I(this,"notes");I(this,"selectedCell");I(this,"noteMode",K(!1));I(this,"valueCounts");I(this,"cellEditable");I(this,"violatedCells");I(this,"gameComplete",K(!1));I(this,"timePass",K(0));I(this,"timeStart",K(Date.now()));I(this,"canUndo",K(!1));this.board=J(this.state,e=>e.board),this.notes=J(this.state,e=>e.notes),this.selectedCell=J(this.state,e=>e.selectedCell),this.valueCounts=J(this.board,e=>rt(e)),this.cellEditable=J(this.selectedCell,e=>this.isEditableCell(e.row,e.col)),this.violatedCells=J(this.board,e=>fe(e))}init(e,l){const t=de.loadCurrentGame(l),s=t?t.state:be(e,l);this.state.set(s),this.initialBoard=l,this.stateHistoryStack.length=0,this.timePass.set(t?t.timePass:0),this.timeStart.set(Date.now())}get isInNodeMode(){return T(this.noteMode)}clearBoard(){this.updateState(e=>({...e,board:this.initialBoard,notes:Array(9).fill(null).map(()=>Array(9).fill(null).map(()=>Array(9).fill(!1))),noteMode:!1})),this.gameComplete.set(!1)}selectCell(e,l){this.updateState(t=>({...t,selectedCell:{row:e,col:l}}))}toggleNoteMode(){this.noteMode.set(!this.isInNodeMode)}enterDigit(e){this.updateState(l=>{const{row:t,col:s}=l.selectedCell;if(!this.isEditableCell(t,s))return l;const o=[...l.board.map(u=>[...u])],i=[...l.notes.map(u=>[...u.map(r=>[...r])])];if(this.isInNodeMode)i[t][s][e-1]=!i[t][s][e-1];else{o[t][s]=e;const u=Math.floor(t/3)*3,r=Math.floor(s/3)*3;for(let n=0;n<9;n++){i[t][n][e-1]=!1,i[n][s][e-1]=!1;const y=u+Math.floor(n/3),v=r+n%3;i[y][v][e-1]=!1}}return{...l,board:o,notes:i}}),this.updateCompleteState()}clearSelectedCell(){this.updateState(e=>{const{row:l,col:t}=e.selectedCell;if(!this.isEditableCell(l,t))return e;const s=[...e.board.map(i=>[...i])],o=[...e.notes.map(i=>[...i.map(u=>[...u])])];return s[l][t]!==0?s[l][t]=0:o[l][t]=Array(9).fill(!1),{...e,board:s,notes:o}}),this.gameComplete.set(!1)}undo(){const e=this.stateHistoryStack.pop();e&&(this.state.set({...e,selectedCell:at(e,T(this.state))}),this.canUndo.set(this.stateHistoryStack.length>0))}isInitial(e,l){return this.initialBoard[e][l]!==0}isSameBox(e,l){const t=T(this.selectedCell);if(!t||t.row===-1||t.col===-1)return!1;const s=Math.floor(e/3),o=Math.floor(l/3),i=Math.floor(t.row/3),u=Math.floor(t.col/3);return s===i&&o===u}hasSameValue(e,l){const t=T(this.selectedCell),s=T(this.board);if(!t||!s||t.row===-1||t.col===-1)return!1;const o=s[t.row][t.col];return!!(o&&s[e][l]===o)}isEditableCell(e,l){return e===-1||l===-1?!1:this.initialBoard[e][l]===0}updateCompleteState(){const e=T(this.board);if(!e.every(s=>s.every(o=>o>0))){this.gameComplete.set(!1);return}if(fe(e).length>0){this.gameComplete.set(!1);return}this.gameComplete.set(!0)}updateState(e){this.state.update(l=>{const t=e(l),s=T(this.timeStart),o=T(this.timePass)+(Date.now()-s)/1e3;return de.saveCurrentGame(this.initialBoard,t,o),re(l.board,t.board)&&re(l.notes,t.notes)||(this.stateHistoryStack.push(l),this.canUndo.set(!0)),t})}}var nt=N('<div class="overlay svelte-m821eu"><div class="complete-card svelte-m821eu"><h2 class="svelte-m821eu">Puzzle Completed!</h2> <p class="svelte-m821eu"> </p> <button class="new-game-btn svelte-m821eu">New Game</button></div></div>');function ct(a,e){O(e,!1);let l=A(e,"levelId",8);function t(){me(W("/"))}R();var s=nt();we(n=>{L(()=>pe.title=`Sudoku 1024: ${$[l()].name??""} Complete`)});var o=g(s),i=G(g(o),2),u=g(i);b(i);var r=G(i,2);b(o),b(s),L(()=>Y(u,`Congratulations! You've successfully completed the ${$[l()].name??""} puzzle.`)),z("click",r,t),M(a,s),q()}var ut=N('<div class="header svelte-1xkek1d"><button class="back-btn svelte-1xkek1d">Back</button> <div class="title svelte-1xkek1d"><h1 class="svelte-1xkek1d"> </h1> <h2 class="svelte-1xkek1d"> </h2></div></div>');function dt(a,e){O(e,!1);const l=_();let t=A(e,"levelId",8);const s=le();let o=_(0),i=!1;function u(){me(W("/"))}te(()=>{const p=setInterval(()=>{i||Ge(o)},1e3),x=s.timePass.subscribe(E=>{k(o,E)}),V=s.gameComplete.subscribe(E=>{i=E});return()=>{clearInterval(p),x(),V()}}),ee(()=>c(o),()=>{k(l,new Date(c(o)*1e3).toISOString().substr(11,8))}),ie(),R();var r=ut(),n=g(r),y=G(n,2),v=g(y),w=g(v,!0);b(v);var C=G(v,2),h=g(C,!0);b(C),b(y),b(r),L(()=>{Y(w,$[t()].name),Y(h,c(l))}),z("click",n,u),M(a,r),q()}var vt=N('<div><!> <div><div><!></div> <div class="controls-container svelte-1lbps5s"><!></div></div> <!></div>');function ft(a,e){O(e,!1);const l=_();let t=A(e,"levelId",8),s=A(e,"initialBoard",8);const o=new it;o.init(t(),s()),ze(o);let i=_(!1),u=_(!1),r=_(0),n=_(0);te(()=>{const d=o.gameComplete.subscribe(P=>{k(i,P)});return()=>{d()}});function y(d){if(!c(i))if(d.key.match(/[1-9]/)){const P=parseInt(d.key,10);o.enterDigit(P)}else d.key==="Backspace"?o.clearSelectedCell():d.key==="Enter"||d.key===" "?o.toggleNoteMode():d.key==="ArrowUp"?v(-1,0):d.key==="ArrowDown"?v(1,0):d.key==="ArrowLeft"?v(0,-1):d.key==="ArrowRight"?v(0,1):d.key==="z"&&(d.ctrlKey||d.metaKey)&&o.undo()}function v(d,P){const m=T(o.selectedCell);m.row===-1||m.col===-1?(m.row=0,m.col=0):(m.row+=d,m.col+=P),m.row<0&&(m.row=8),m.row>8&&(m.row=0),m.col<0&&(m.col=8),m.col>8&&(m.col=0),o.selectCell(m.row,m.col)}ee(()=>(c(r),c(n)),()=>{k(u,c(r)>c(n)||c(r)>650)}),ee(()=>(c(n),c(u),c(r)),()=>{k(l,c(n)>0&&!c(u)&&c(r)/c(n)>.65)}),ie(),R();var w=vt();z("keydown",De,y);let C;var h=g(w);dt(h,{get levelId(){return t()}});var p=G(h,2);let x;var V=g(p);let E;var f=g(V);We(f,{}),b(V);var S=G(V,2),D=g(S);st(D,{}),b(S),b(p);var U=G(p,2);{var B=d=>{ct(d,{get levelId(){return t()}})};ae(U,d=>{c(i)&&d(B)})}b(w),L((d,P,m)=>{C=j(w,1,"container svelte-1lbps5s",null,C,d),x=j(p,1,"game-content svelte-1lbps5s",null,x,P),E=j(V,1,"board-container svelte-1lbps5s",null,E,m)},[()=>({"wide-layout":c(u)}),()=>({"wide-layout":c(u)}),()=>({"square-layout":c(l)})],H),ue("innerWidth",d=>k(r,d)),ue("innerHeight",d=>k(n,d)),M(a,w),q()}function yt(a,e){O(e,!1);let l=A(e,"data",8);R(),we(t=>{L(()=>pe.title=`Sudoku 1024: ${$[l().levelId].name??""}`)}),ft(a,{get levelId(){return l().levelId},get initialBoard(){return l().board}}),q()}export{yt as component,_t as universal};
