var Ne=Object.defineProperty;var Ae=(o,e,l)=>e in o?Ne(o,e,{enumerable:!0,configurable:!0,writable:!0,value:l}):o[e]=l;var B=(o,e,l)=>Ae(o,typeof e!="symbol"?e+"":e,l);import{b as Ve,d as Ee,g as xe,a as F,e as Z,i as $,c as Pe,f as pe,L as ee}from"../chunks/oD7bGzRd.js";import{R as Ge,w as K,d as J,g as Ce}from"../chunks/BBr3HQm-.js";import{t as V,a as S,c as ue,n as Se}from"../chunks/BdziLC_p.js";import{i as R}from"../chunks/CtBiNhbk.js";import{o as de,aG as Ue,aH as qe,s as O,aI as te,D as _,aJ as y,f as ie,aK as ne,w as g,x as h,t as L,V as T,g as n,v as j,q as ve,y as G,aa as fe,ab as _e,aL as ze,aM as De}from"../chunks/BCWV8hfl.js";import{l as Le,w as Te,e as D,s as W,h as ye}from"../chunks/DkYXUU7v.js";import{p as A,i as Q}from"../chunks/DP-PKcU7.js";import{o as le}from"../chunks/D3_g4ptc.js";function H(o,e,l,t,s,a){var r=o.__className;if(de||r!==l){var u=Ve(l,t,a);(!de||u!==o.getAttribute("class"))&&(u==null?o.removeAttribute("class"):o.className=u),o.__className=l}else if(a&&s!==a)for(var i in a){var d=!!a[i];(s==null||d!==!!s[i])&&o.classList.toggle(i,d)}return a}function he(o,e){Le(window,["resize"],()=>Te(()=>e(window[o])))}function He(o){const e=Ee(o);if(e===null||e.length!==81)return null;const l=[];for(let t=0;t<9;t++){const s=[];for(let a=0;a<9;a++)s.push(e[t*9+a]);l.push(s)}return l}function X(o,e){throw new Ge(o,e.toString())}new TextEncoder;const Re=({url:o})=>{const e=o.searchParams.get("game");if(!e)throw X(303,F("/"));const l=parseInt(e[0]);if(isNaN(l)||l<1||l>4)throw X(303,F("/"));const t=l;if(!t)throw X(303,F("/"));let s=e.substring(1);const a=s?He(s):null;if(!a)throw s=xe.generateBoardString(t),X(303,`play?game=${l}${s}`);return{levelId:t,board:a}},It=Object.freeze(Object.defineProperty({__proto__:null,load:Re},Symbol.toStringTag,{value:"Module"})),ke=Symbol("sudoku-view-model");function Oe(o){Ue(ke,o)}function se(){return qe(ke)}var je=V('<span class="cell-value svelte-akfsra"> </span>'),Ke=V('<div class="note-cell svelte-akfsra"><span class="note-value svelte-akfsra"></span></div>'),Je=V('<div class="notes-grid svelte-akfsra"></div>'),Fe=V("<div><!></div>");function We(o,e){O(e,!1);const l=y();let t=A(e,"rowIndex",8),s=A(e,"colIndex",8),a=A(e,"cellValue",8),r=A(e,"isInitial",8),u=A(e,"notes",8),i=A(e,"selectedCell",8),d=A(e,"valueCounts",8),I=A(e,"violatedCells",8);const b=se();function w(v,C){return b.isSameBox(v,C)}function k(v,C){return b.hasSameValue(v,C)}te(()=>(ie(I()),ie(t()),ie(s())),()=>{_(l,I().some(v=>v.row===t()&&v.col===s()))}),ne(),R();var f=Fe();let p;var N=g(f);{var E=v=>{var C=je(),q=g(C,!0);h(C),L(()=>W(q,a())),S(v,C)},U=v=>{var C=ue(),q=ve(C);{var x=M=>{var c=Je();Z(c,4,()=>Array(9).fill(null),$,(P,m,Y)=>{var ce=ue(),Me=ve(ce);{var Be=ae=>{var oe=Ke(),Ie=g(oe);Ie.textContent=Y+1,h(oe),S(ae,oe)};Q(Me,ae=>{u()[Y]&&ae(Be)})}S(P,ce)}),h(c),S(M,c)};Q(q,M=>{u().some(c=>c)&&M(x)})}S(v,C)};Q(N,v=>{a()?v(E):v(U,!1)})}h(f),L(v=>p=H(f,1,"cell svelte-akfsra",null,p,v),[()=>({selected:i().row===t()&&i().col===s(),"same-line":i().row===t()||i().col===s(),"same-box":w(t(),s())&&!(i().row===t()&&i().col===s()),"same-value":k(t(),s())&&!(i().row===t()&&i().col===s()),complete:a()&&d()[a()]>=9,violated:n(l),initial:r()})],T),D("click",f,()=>b.selectCell(t(),s())),S(o,f),j()}var Ye=V("<div><!></div>"),Xe=V('<div class="row svelte-1iqdaqq"></div>'),Qe=V('<div class="sudoku-board svelte-1iqdaqq"></div>');function Ze(o,e){O(e,!1);let l=y([]),t=y([]),s=y({row:-1,col:-1});const a=se();let r=y([]),u=y([]);le(()=>{const d=a.board.subscribe(f=>{_(l,f)}),I=a.notes.subscribe(f=>{_(t,f)}),b=a.selectedCell.subscribe(f=>{_(s,f)}),w=a.valueCounts.subscribe(f=>{_(r,f)}),k=a.violatedCells.subscribe(f=>{_(u,f)});return()=>{d(),I(),b(),w(),k()}}),R();var i=Qe();Z(i,5,()=>n(l),$,(d,I,b)=>{var w=Xe();Z(w,5,()=>n(I),$,(k,f,p)=>{var N=Ye();H(N,1,"cell svelte-1iqdaqq",null,{},{"border-bottom-thick":b%3===2&&b<8,"border-right-thick":p%3===2&&p<8});var E=g(N);const U=T(()=>a.isInitial(b,p));We(E,{rowIndex:b,colIndex:p,get cellValue(){return n(f)},get isInitial(){return n(U)},get notes(){return n(t)[b][p]},get selectedCell(){return n(s)},get valueCounts(){return n(r)},get violatedCells(){return n(u)}}),h(N),S(k,N)}),h(w),S(d,w)}),h(i),S(o,i),j()}var $e=Se('<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path></svg>');function et(o){var e=$e();S(o,e)}var tt=V('<div class="container svelte-1kzvdff"><p class="tip svelte-1kzvdff">Tip: Select a cell and press 1-9 to enter values. Use note mode for candidates.</p> <p class="tip svelte-1kzvdff">Any issue or suggestion? <br>Please report on <a href="https://github.com/tuanchauict/sudoku-1024/" target="_blank">GitHub</a> of the project.</p></div>');function lt(o){var e=tt();S(o,e)}var st=Se('<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" stroke="none" viewBox="0 0 24 24"><path d="M12.5 8c-2.65 0-5.05.99-6.9 2.6L2 7v9h9l-3.62-3.62c1.39-1.16 3.16-1.88 5.12-1.88 3.54 0 6.55 2.31 7.6 5.5l2.37-.78C21.08 11.03 17.15 8 12.5 8z"></path></svg>');function at(o){var e=st();S(o,e)}var ot=V("<button> </button>"),it=V('<div class="container svelte-1l8nhu6"><div class="digits-container svelte-1l8nhu6"><!> <button class="btn digit-button clear-btn svelte-1l8nhu6"><span>&#10005;</span></button></div> <div class="actions-container svelte-1l8nhu6"><button class="btn action-button svelte-1l8nhu6"><!> <span>Undo</span></button> <button><!> <span>Note</span></button></div> <!></div>');function rt(o,e){O(e,!1);let l=y(Array(10).fill(0)),t=y(!1),s=y(!0),a=y(!1);const r=se();function u(v){r.enterDigit(v)}le(()=>{const v=r.noteMode.subscribe(M=>{_(t,M)}),C=r.cellEditable.subscribe(M=>{_(s,M)}),q=r.canUndo.subscribe(M=>{_(a,M)}),x=r.valueCounts.subscribe(M=>{_(l,M)});return()=>{v(),C(),q(),x()}}),R();var i=it(),d=g(i),I=g(d);Z(I,0,()=>Array(9).fill(null),$,(v,C,q)=>{var x=ot();const M=T(()=>q+1),c=T(()=>n(l)[q+1]);let P;var m=g(x,!0);h(x),L(Y=>{P=H(x,1,"btn digit-button svelte-1l8nhu6",null,P,Y),x.disabled=n(c)>=9,W(m,n(M))},[()=>({disabled:n(c)>=9})],T),D("click",x,()=>u(n(M))),S(v,x)});var b=G(I,2);h(d);var w=G(d,2),k=g(w),f=g(k);at(f),fe(2),h(k);var p=G(k,2);let N;var E=g(p);et(E),fe(2),h(p),h(w);var U=G(w,2);lt(U),h(i),L(v=>{b.disabled=!n(s),k.disabled=!n(a),N=H(p,1,"btn action-button note-btn svelte-1l8nhu6",null,N,v)},[()=>({active:n(t)})],T),D("click",b,()=>r.clearSelectedCell()),D("click",k,()=>r.undo()),D("click",p,()=>r.toggleNoteMode()),S(o,i),j()}const nt="sudoku";class be{static saveCurrentGame(e,l,t){const s={state:l,timePass:t};localStorage.setItem(me(e),JSON.stringify(s))}static loadCurrentGame(e){const l=localStorage.getItem(me(e));if(!l)return null;const t=JSON.parse(l);return t.state?t:null}}function me(o){const e=o.flatMap(l=>l);return`${nt}_${Pe(e)}`}function re(o,e){return JSON.stringify(o)===JSON.stringify(e)}function z(o){let e;return o.subscribe(t=>{e=t})(),e}function ge(o){const e=[],l=(t,s)=>e.some(a=>a.row===t&&a.col===s);for(let t=0;t<9;t++)for(let s=0;s<9;s++){const a=o[t][s];if(!a||l(t,s))continue;for(let i=0;i<9;i++)i!==s&&o[t][i]===a&&(l(t,s)||e.push({row:t,col:s}),l(t,i)||e.push({row:t,col:i}));for(let i=0;i<9;i++)i!==t&&o[i][s]===a&&(l(t,s)||e.push({row:t,col:s}),l(i,s)||e.push({row:i,col:s}));const r=Math.floor(t/3)*3,u=Math.floor(s/3)*3;for(let i=r;i<r+3;i++)for(let d=u;d<u+3;d++)(i!==t||d!==s)&&o[i][d]===a&&(l(t,s)||e.push({row:t,col:s}),l(i,d)||e.push({row:i,col:d}))}return e}function ct(o,e){let l=0,t=0;for(let s=0;s<9;s++)for(let a=0;a<9;a++)if(e.board[s][a]!==o.board[s][a]||!re(e.notes[s][a],o.notes[s][a])){l=s,t=a;break}return{row:l,col:t}}function ut(o){const e=Array(10).fill(0);for(let l=0;l<9;l++)for(let t=0;t<9;t++)o[l][t]&&e[o[l][t]]++;return e}const we=pe(0,Array(9).fill(Array(9).fill(0)));class dt{constructor(){B(this,"initialBoard",we.initialBoard);B(this,"state",K(we));B(this,"stateHistoryStack",[]);B(this,"board");B(this,"notes");B(this,"selectedCell");B(this,"noteMode",K(!1));B(this,"valueCounts");B(this,"cellEditable");B(this,"violatedCells");B(this,"gameComplete",K(!1));B(this,"timePass",K(0));B(this,"timeStart",K(Date.now()));B(this,"canUndo",K(!1));this.board=J(this.state,e=>e.board),this.notes=J(this.state,e=>e.notes),this.selectedCell=J(this.state,e=>e.selectedCell),this.valueCounts=J(this.board,e=>ut(e)),this.cellEditable=J(this.selectedCell,e=>this.isEditableCell(e.row,e.col)),this.violatedCells=J(this.board,e=>ge(e))}init(e,l){const t=be.loadCurrentGame(l),s=t?t.state:pe(e,l);this.state.set(s),this.initialBoard=l,this.stateHistoryStack.length=0,this.timePass.set(t?t.timePass:0),this.timeStart.set(Date.now())}get isInNodeMode(){return z(this.noteMode)}clearBoard(){this.updateState(e=>({...e,board:this.initialBoard,notes:Array(9).fill(null).map(()=>Array(9).fill(null).map(()=>Array(9).fill(!1))),noteMode:!1})),this.gameComplete.set(!1)}selectCell(e,l){this.updateState(t=>({...t,selectedCell:{row:e,col:l}}))}toggleNoteMode(){this.noteMode.set(!this.isInNodeMode)}enterDigit(e){this.updateState(l=>{const{row:t,col:s}=l.selectedCell;if(!this.isEditableCell(t,s))return l;const a=[...l.board.map(u=>[...u])],r=[...l.notes.map(u=>[...u.map(i=>[...i])])];return this.isInNodeMode?r[t][s][e-1]=!r[t][s][e-1]:a[t][s]=e,{...l,board:a,notes:r}}),this.updateCompleteState()}clearSelectedCell(){this.updateState(e=>{const{row:l,col:t}=e.selectedCell;if(!this.isEditableCell(l,t))return e;const s=[...e.board.map(r=>[...r])],a=[...e.notes.map(r=>[...r.map(u=>[...u])])];return s[l][t]!==0?s[l][t]=0:a[l][t]=Array(9).fill(!1),{...e,board:s,notes:a}}),this.gameComplete.set(!1)}undo(){const e=this.stateHistoryStack.pop();e&&(this.state.set({...e,selectedCell:ct(e,z(this.state))}),this.canUndo.set(this.stateHistoryStack.length>0))}isInitial(e,l){return this.initialBoard[e][l]!==0}isSameBox(e,l){const t=z(this.selectedCell);if(!t||t.row===-1||t.col===-1)return!1;const s=Math.floor(e/3),a=Math.floor(l/3),r=Math.floor(t.row/3),u=Math.floor(t.col/3);return s===r&&a===u}hasSameValue(e,l){const t=z(this.selectedCell),s=z(this.board);if(!t||!s||t.row===-1||t.col===-1)return!1;const a=s[t.row][t.col];return!!(a&&s[e][l]===a)}isEditableCell(e,l){return e===-1||l===-1?!1:this.initialBoard[e][l]===0}updateCompleteState(){const e=z(this.board);if(!e.every(s=>s.every(a=>a>0))){this.gameComplete.set(!1);return}if(ge(e).length>0){this.gameComplete.set(!1);return}this.gameComplete.set(!0)}updateState(e){this.state.update(l=>{const t=e(l),s=z(this.timeStart),a=z(this.timePass)+(Date.now()-s)/1e3;return be.saveCurrentGame(this.initialBoard,t,a),re(l.board,t.board)&&re(l.notes,t.notes)||(this.stateHistoryStack.push(l),this.canUndo.set(!0)),t})}}var vt=V('<div class="overlay svelte-47ei2l"><div class="complete-card svelte-47ei2l"><h2 class="svelte-47ei2l">Puzzle Completed!</h2> <p class="svelte-47ei2l"> </p> <button class="new-game-btn svelte-47ei2l">New Game</button></div></div>');function ft(o,e){O(e,!1);let l=A(e,"levelId",8);function t(){Ce(F("/"))}R();var s=vt();ye(d=>{L(()=>_e.title=`Sudoku 1024: ${ee[l()].name??""} Complete`)});var a=g(s),r=G(g(a),2),u=g(r);h(r);var i=G(r,2);h(a),h(s),L(()=>W(u,`Congratulations! You've successfully completed the ${ee[l()].name??""} puzzle.`)),D("click",i,t),S(o,s),j()}var ht=V('<div class="header svelte-1eechvy"><button class="back-btn svelte-1eechvy">Back</button> <div class="title svelte-1eechvy"><h1 class="svelte-1eechvy"> </h1> <h2 class="svelte-1eechvy"> </h2></div> <button class="clear-btn svelte-1eechvy">Reset</button></div>');function bt(o,e){O(e,!1);const l=y();let t=A(e,"levelId",8);const s=se();let a=y(0),r=!1;function u(){Ce(F("/"))}function i(){s.clearBoard()}le(()=>{const E=setInterval(()=>{r||ze(a)},1e3),U=s.timePass.subscribe(C=>{_(a,C)}),v=s.gameComplete.subscribe(C=>{r=C});return()=>{clearInterval(E),U(),v()}}),te(()=>n(a),()=>{_(l,new Date(n(a)*1e3).toISOString().substr(11,8))}),ne(),R();var d=ht(),I=g(d),b=G(I,2),w=g(b),k=g(w,!0);h(w);var f=G(w,2),p=g(f,!0);h(f),h(b);var N=G(b,2);h(d),L(()=>{W(k,ee[t()].name),W(p,n(l))}),D("click",I,u),D("click",N,i),S(o,d),j()}var mt=V('<div><!> <div><div><!></div> <div class="controls-container svelte-1lnc43"><!></div></div> <!></div>');function gt(o,e){O(e,!1);const l=y();let t=A(e,"levelId",8),s=A(e,"initialBoard",8);const a=new dt;a.init(t(),s()),Oe(a);let r=y(!1),u=y(!1),i=y(0),d=y(0);le(()=>{const c=a.gameComplete.subscribe(P=>{_(r,P)});return()=>{c()}});function I(c){if(!n(r))if(c.key.match(/[1-9]/)){const P=parseInt(c.key,10);a.enterDigit(P)}else c.key==="Backspace"?a.clearSelectedCell():c.key==="Enter"||c.key===" "?a.toggleNoteMode():c.key==="ArrowUp"?b(-1,0):c.key==="ArrowDown"?b(1,0):c.key==="ArrowLeft"?b(0,-1):c.key==="ArrowRight"?b(0,1):c.key==="z"&&(c.ctrlKey||c.metaKey)&&a.undo()}function b(c,P){const m=z(a.selectedCell);m.row===-1||m.col===-1?(m.row=0,m.col=0):(m.row+=c,m.col+=P),m.row<0&&(m.row=8),m.row>8&&(m.row=0),m.col<0&&(m.col=8),m.col>8&&(m.col=0),a.selectCell(m.row,m.col)}te(()=>(n(i),n(d)),()=>{_(u,n(i)>n(d)||n(i)>650)}),te(()=>(n(d),n(u),n(i)),()=>{_(l,n(d)>0&&!n(u)&&n(i)/n(d)>.65)}),ne(),R();var w=mt();D("keydown",De,I);let k;var f=g(w);bt(f,{get levelId(){return t()}});var p=G(f,2);let N;var E=g(p);let U;var v=g(E);Ze(v,{}),h(E);var C=G(E,2),q=g(C);rt(q,{}),h(C),h(p);var x=G(p,2);{var M=c=>{ft(c,{get levelId(){return t()}})};Q(x,c=>{n(r)&&c(M)})}h(w),L((c,P,m)=>{k=H(w,1,"container svelte-1lnc43",null,k,c),N=H(p,1,"game-content svelte-1lnc43",null,N,P),U=H(E,1,"board-container svelte-1lnc43",null,U,m)},[()=>({"wide-layout":n(u)}),()=>({"wide-layout":n(u)}),()=>({"square-layout":n(l)})],T),he("innerWidth",c=>_(i,c)),he("innerHeight",c=>_(d,c)),S(o,w),j()}function Nt(o,e){O(e,!1);let l=A(e,"data",8);R(),ye(t=>{L(()=>_e.title=`Sudoku 1024: ${ee[l().levelId].name??""}`)}),gt(o,{get levelId(){return l().levelId},get initialBoard(){return l().board}}),j()}export{Nt as component,It as universal};
