var Ce=Object.defineProperty;var we=(i,e,s)=>e in i?Ce(i,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):i[e]=s;var I=(i,e,s)=>we(i,typeof e!="symbol"?e+"":e,s);import{a as pe,b as _e,g as Se,e as ee,i as te}from"../chunks/CDP4jprq.js";import{R as ye,w as oe,d as T,g as he,b as ge}from"../chunks/C2bJBQ3E.js";import{t as A,a as y,c as Be,n as Me}from"../chunks/C__5v9kr.js";import{i as U}from"../chunks/Dj8PqmZs.js";import{o as ue,aC as ke,aD as Ne,s as q,aE as le,F as M,aF as S,f as re,aG as ie,w as m,x as h,t as L,X as H,g as r,v as F,q as Ae,y as z,z as Ie,aH as Ve,aI as ze,aJ as j}from"../chunks/DYrX2ids.js";import{p as _,i as $}from"../chunks/Dr2BO5k9.js";import{l as xe,w as Ee,e as O,s as X}from"../chunks/DtG3s25q.js";import{o as se}from"../chunks/BiPqryrm.js";function J(i,e,s,t,a,l){var c=i.__className;if(ue||c!==s){var u=pe(s,t,l);(!ue||u!==i.getAttribute("class"))&&(u==null?i.removeAttribute("class"):i.className=u),i.__className=s}else if(l&&a!==l)for(var o in l){var n=!!l[o];(a==null||n!==!!a[o])&&i.classList.toggle(o,n)}return l}function de(i,e){xe(window,["resize"],()=>Ee(()=>e(window[i])))}function ve(i,e){throw new ye(i,e.toString())}new TextEncoder;const De=({url:i})=>{const e=i.searchParams.get("level");if(!e)throw ve(303,"/");let s=i.searchParams.get("board");const t=s?_e(s):null;if(!t)throw s=Se(e),ve(303,`play?level=${e}&board=${s}`);return{levelId:e,board:t}},bt=Object.freeze(Object.defineProperty({__proto__:null,load:De},Symbol.toStringTag,{value:"Module"})),me=Symbol("sudoku-view-model");function Ge(i){ke(me,i)}function ae(){return Ne(me)}var Pe=A('<span class="cell-value svelte-1eel9hg"> </span>'),je=A('<span class="note-value svelte-1eel9hg"></span>'),Oe=A('<div class="note-cell svelte-1eel9hg"><!></div>'),Re=A('<div class="notes-grid svelte-1eel9hg"></div>'),Te=A("<div><!></div>");function He(i,e){q(e,!1);const s=S();let t=_(e,"rowIndex",8),a=_(e,"colIndex",8),l=_(e,"cellValue",8),c=_(e,"isInitial",8),u=_(e,"notes",8),o=_(e,"selectedCell",8),n=_(e,"valueCounts",8),b=_(e,"violatedCells",8);const v=ae();function w(d,g){return v.isSameBox(d,g)}function C(d,g){return v.hasSameValue(d,g)}le(()=>(re(b()),re(t()),re(a())),()=>{M(s,b().some(d=>d.row===t()&&d.col===a()))}),ie(),U();var p=Te();let k;var B=m(p);{var N=d=>{var g=Pe(),V=m(g,!0);h(g),L(()=>X(V,l())),y(d,g)},E=d=>{var g=Be(),V=Ae(g);{var R=P=>{var x=Re();ee(x,4,()=>Array(9).fill(null),te,(K,ce,Q)=>{var f=Oe(),D=m(f);{var W=Y=>{var Z=je();Z.textContent=Q+1,y(Y,Z)};$(D,Y=>{u()[Q]&&Y(W)})}h(f),y(K,f)}),h(x),y(P,x)};$(V,P=>{u().some(x=>x)&&P(R)})}y(d,g)};$(B,d=>{l()?d(N):d(E,!1)})}h(p),L(d=>k=J(p,1,"cell svelte-1eel9hg",null,k,d),[()=>({selected:o().row===t()&&o().col===a(),"same-line":o().row===t()||o().col===a(),"same-box":w(t(),a())&&!(o().row===t()&&o().col===a()),"same-value":C(t(),a())&&!(o().row===t()&&o().col===a()),complete:l()&&n()[l()]>=9,violated:r(s),initial:c()})],H),O("click",p,()=>v.selectCell(t(),a())),y(i,p),F()}var Je=A("<div><!></div>"),Le=A('<div class="row svelte-cpzb4l"></div>'),Ue=A('<div class="sudoku-board svelte-cpzb4l"></div>');function qe(i,e){q(e,!1);let s=_(e,"board",24,()=>[]),t=_(e,"notes",24,()=>[]),a=_(e,"selectedCell",24,()=>({row:-1,col:-1}));const l=ae();let c=S([]),u=S([]);se(()=>{const n=l.valueCounts.subscribe(v=>{M(c,v)}),b=l.violatedCells.subscribe(v=>{M(u,v)});return()=>{n(),b()}}),U();var o=Ue();ee(o,5,s,te,(n,b,v)=>{var w=Le();ee(w,5,()=>r(b),te,(C,p,k)=>{var B=Je();J(B,1,"cell svelte-cpzb4l",null,{},{"border-bottom-thick":v%3===2&&v<8,"border-right-thick":k%3===2&&k<8});var N=m(B);const E=H(()=>l.initialBoard[v][k]!==0);He(N,{rowIndex:v,colIndex:k,get cellValue(){return r(p)},get isInitial(){return r(E)},get notes(){return t()[v][k]},get selectedCell(){return a()},get valueCounts(){return r(c)},get violatedCells(){return r(u)}}),h(B),y(C,B)}),h(w),y(n,w)}),h(o),y(i,o),F()}var Fe=Me('<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path></svg>');function Ke(i){var e=Fe();y(i,e)}var We=A('<div class="tip svelte-1h2zn7p">Tip: Select a cell and press 1-9 to enter values. Use note mode for candidates.</div>');function Ye(i){var e=We();y(i,e)}var Xe=A("<button> </button>"),Qe=A('<div class="container svelte-1zj3si"><div class="digits-container svelte-1zj3si"><!> <button class="digit-button clear-btn svelte-1zj3si"><span>&#10005;</span></button></div> <div class="actions-container svelte-1zj3si"><button><!> <span>Note</span></button></div> <!></div>');function Ze(i,e){q(e,!1);let s=_(e,"digitCounts",24,()=>Array(9).fill(0)),t=S(!1),a=S(!0);const l=ae();function c(N){l.enterDigit(N)}function u(){l.toggleNoteMode()}se(()=>{const N=l.noteMode.subscribe(d=>{M(t,d)}),E=l.cellEditable.subscribe(d=>{M(a,d)});return()=>{N(),E()}}),U();var o=Qe(),n=m(o),b=m(n);ee(b,0,()=>Array(9).fill(null),te,(N,E,d)=>{var g=Xe();const V=H(()=>d+1),R=H(()=>s()[d]);let P;var x=m(g,!0);h(g),L(K=>{P=J(g,1,"digit-button svelte-1zj3si",null,P,K),g.disabled=r(R)>=9,X(x,r(V))},[()=>({disabled:r(R)>=9})],H),O("click",g,()=>c(r(V))),y(N,g)});var v=z(b,2);h(n);var w=z(n,2),C=m(w);let p;var k=m(C);Ke(k),Ie(2),h(C),h(w);var B=z(w,2);Ye(B),h(o),L(N=>{v.disabled=!r(a),p=J(C,1,"action-button note-btn svelte-1zj3si",null,p,N)},[()=>({active:r(t)})],H),O("click",v,()=>l.clearSelectedCell()),O("click",C,u),y(i,o),F()}const fe="sudoku";class be{static saveCurrentGame(e,s,t){const a={initialBoard:e,state:s,timePass:t};localStorage.setItem(fe,JSON.stringify(a))}static loadCurrentGame(e){const s=localStorage.getItem(fe);if(!s)return null;const t=JSON.parse(s);return JSON.stringify(t.initialBoard)!==JSON.stringify(e)||!t.state?null:t}}class ne{constructor(e,s){I(this,"state");I(this,"board");I(this,"notes");I(this,"selectedCell");I(this,"noteMode",oe(!1));I(this,"digitCounts");I(this,"valueCounts");I(this,"cellEditable");I(this,"violatedCells");I(this,"gameComplete");I(this,"timePass");I(this,"timeStart",Date.now());this.levelId=e,this.initialBoard=s;const t=be.loadCurrentGame(s),a=t?t.state:ne.createState(s);this.timePass=t?t.timePass:0,this.state=oe(a),this.board=T(this.state,l=>l.board),this.notes=T(this.state,l=>l.notes),this.selectedCell=T(this.state,l=>l.selectedCell),this.digitCounts=T(this.board,l=>this.calculateDigitCounts(l)),this.valueCounts=T(this.board,l=>this.calculateValueCounts(l)),this.cellEditable=T(this.selectedCell,l=>this.isEditableCell(l.row,l.col)),this.violatedCells=T(this.board,l=>this.findViolatedCells(l)),this.gameComplete=oe(!1)}static createState(e){return{board:e,notes:Array(9).fill(null).map(()=>Array(9).fill(null).map(()=>Array(9).fill(!1))),selectedCell:{row:-1,col:-1}}}get currentGameState(){let e;return this.state.subscribe(t=>{})(),e}get isInNodeMode(){let e=!1;return this.noteMode.subscribe(t=>{e=t})(),e}get currentSelectedCell(){let e={row:-1,col:-1};return this.selectedCell.subscribe(t=>{e=t})(),e}get currentBoard(){let e=this.initialBoard;return this.board.subscribe(t=>{e=t})(),e}clearBoard(){this.updateState(e=>({...e,board:this.initialBoard,notes:Array(9).fill(null).map(()=>Array(9).fill(null).map(()=>Array(9).fill(!1))),selectedCell:{row:-1,col:-1},noteMode:!1})),this.gameComplete.set(!1)}selectCell(e,s){this.updateState(t=>({...t,selectedCell:{row:e,col:s}}))}toggleNoteMode(){this.noteMode.set(!this.noteMode)}enterDigit(e){this.updateState(s=>{const{row:t,col:a}=s.selectedCell;if(!this.isEditableCell(t,a))return s;const l=[...s.board.map(u=>[...u])],c=[...s.notes.map(u=>[...u.map(o=>[...o])])];return this.isInNodeMode?c[t][a][e-1]=!c[t][a][e-1]:l[t][a]=e,{...s,board:l,notes:c}}),this.updateCompleteState()}clearSelectedCell(){this.updateState(e=>{const{row:s,col:t}=e.selectedCell;if(!this.isEditableCell(s,t))return e;const a=[...e.board.map(c=>[...c])],l=[...e.notes.map(c=>[...c.map(u=>[...u])])];return a[s][t]!==0?a[s][t]=0:l[s][t]=Array(9).fill(!1),{...e,board:a,notes:l}}),this.gameComplete.set(!1)}calculateDigitCounts(e){const s=Array(9).fill(0);for(let t=0;t<9;t++)for(let a=0;a<9;a++)e[t][a]>0&&s[e[t][a]-1]++;return s}calculateValueCounts(e){const s=Array(10).fill(0);for(let t=0;t<9;t++)for(let a=0;a<9;a++)e[t][a]&&s[e[t][a]]++;return s}isSameBox(e,s){let t=this.currentSelectedCell;if(!t||t.row===-1||t.col===-1)return!1;const a=Math.floor(e/3),l=Math.floor(s/3),c=Math.floor(t.row/3),u=Math.floor(t.col/3);return a===c&&l===u}hasSameValue(e,s){let t=this.currentSelectedCell,a=this.currentBoard;if(!t||!a||t.row===-1||t.col===-1)return!1;const l=a[t.row][t.col];return!!(l&&a[e][s]===l)}isEditableCell(e,s){return e===-1||s===-1?!1:this.initialBoard[e][s]===0}findViolatedCells(e){const s=[],t=(a,l)=>s.some(c=>c.row===a&&c.col===l);for(let a=0;a<9;a++)for(let l=0;l<9;l++){const c=e[a][l];if(!c||t(a,l))continue;for(let n=0;n<9;n++)n!==l&&e[a][n]===c&&(t(a,l)||s.push({row:a,col:l}),t(a,n)||s.push({row:a,col:n}));for(let n=0;n<9;n++)n!==a&&e[n][l]===c&&(t(a,l)||s.push({row:a,col:l}),t(n,l)||s.push({row:n,col:l}));const u=Math.floor(a/3)*3,o=Math.floor(l/3)*3;for(let n=u;n<u+3;n++)for(let b=o;b<o+3;b++)(n!==a||b!==l)&&e[n][b]===c&&(t(a,l)||s.push({row:a,col:l}),t(n,b)||s.push({row:n,col:b}))}return s}updateCompleteState(){let e=this.currentBoard;if(!e.every(a=>a.every(l=>l>0))){this.gameComplete.set(!1);return}if(this.findViolatedCells(e).length>0){this.gameComplete.set(!1);return}this.gameComplete.set(!0)}updateState(e){this.state.update(s=>{const t=e(s),a=this.timePass+(Date.now()-this.timeStart)/1e3;return be.saveCurrentGame(this.initialBoard,t,a),t})}}var $e=A('<div class="overlay svelte-e4go0s"><div class="complete-card svelte-e4go0s"><h2 class="svelte-e4go0s">Puzzle Completed!</h2> <p class="svelte-e4go0s"> </p> <button class="new-game-btn svelte-e4go0s">New Game</button></div></div>');function et(i,e){q(e,!1);let s=_(e,"levelId",8);function t(){he(`${ge}/`)}U();var a=$e(),l=m(a),c=z(m(l),2),u=m(c);h(c);var o=z(c,2);h(l),h(a),L(()=>X(u,`Congratulations! You've successfully completed the ${s()??""} puzzle.`)),O("click",o,t),y(i,a),F()}var tt=A('<div class="header svelte-1o91g5p"><button class="back-btn svelte-1o91g5p">Back</button> <div class="title svelte-1o91g5p"><h1 class="svelte-1o91g5p"> </h1> <h2 class="svelte-1o91g5p"> </h2></div> <button class="clear-btn svelte-1o91g5p">Reset</button></div>');function lt(i,e){q(e,!1);const s=S();let t=_(e,"levelId",8);const a=ae();let l=S(a.timePass);function c(){he(`${ge}/`)}function u(){a.clearBoard()}se(()=>{const B=setInterval(()=>{Ve(l)},1e3);return()=>{clearInterval(B)}}),le(()=>r(l),()=>{M(s,new Date(r(l)*1e3).toISOString().substr(11,8))}),ie(),U();var o=tt(),n=m(o),b=z(n,2),v=m(b),w=m(v,!0);h(v);var C=z(v,2),p=m(C,!0);h(C),h(b);var k=z(b,2);h(o),L(()=>{X(w,t()),X(p,r(s))}),O("click",n,c),O("click",k,u),y(i,o),F()}var st=A('<div><!> <div><div><!></div> <div class="controls-container svelte-1lnc43"><!></div></div> <!></div>');function at(i,e){q(e,!1);const s=S();let t=_(e,"levelId",8),a=_(e,"initialBoard",8);const l=new ne(t(),a());Ge(l);let c=S([]),u=S([]),o=S({row:-1,col:-1}),n=S(Array(9).fill(0)),b=S(!1),v=S(!1),w=S(0),C=S(0);se(()=>{const f=l.board.subscribe(G=>{M(c,G)}),D=l.notes.subscribe(G=>{M(u,G)}),W=l.selectedCell.subscribe(G=>{M(o,G)}),Y=l.digitCounts.subscribe(G=>{M(n,G)}),Z=l.gameComplete.subscribe(G=>{M(b,G)});return()=>{f(),D(),W(),Y(),Z()}});function p(f,D){r(o).row===-1||r(o).col===-1?(j(o,r(o).row=0),j(o,r(o).col=0)):(j(o,r(o).row+=f),j(o,r(o).col+=D)),r(o).row<0&&j(o,r(o).row=8),r(o).row>8&&j(o,r(o).row=0),r(o).col<0&&j(o,r(o).col=8),r(o).col>8&&j(o,r(o).col=0),l.selectCell(r(o).row,r(o).col)}function k(f){if(!r(b))if(f.key.match(/[1-9]/)){const D=parseInt(f.key,10);l.enterDigit(D)}else f.key==="Backspace"?l.clearSelectedCell():f.key==="Enter"?l.toggleNoteMode():f.key==="ArrowUp"?p(-1,0):f.key==="ArrowDown"?p(1,0):f.key==="ArrowLeft"?p(0,-1):f.key==="ArrowRight"&&p(0,1)}le(()=>(r(w),r(C)),()=>{M(v,r(w)>r(C))}),le(()=>(r(C),r(v),r(w)),()=>{M(s,r(C)>0&&!r(v)&&r(w)/r(C)>.65)}),ie(),U();var B=st();O("keydown",ze,k);let N;var E=m(B);lt(E,{get levelId(){return t()}});var d=z(E,2);let g;var V=m(d);let R;var P=m(V);qe(P,{get board(){return r(c)},get notes(){return r(u)},get selectedCell(){return r(o)}}),h(V);var x=z(V,2),K=m(x);Ze(K,{get digitCounts(){return r(n)}}),h(x),h(d);var ce=z(d,2);{var Q=f=>{et(f,{get levelId(){return t()}})};$(ce,f=>{r(b)&&f(Q)})}h(B),L((f,D,W)=>{N=J(B,1,"container svelte-1lnc43",null,N,f),g=J(d,1,"game-content svelte-1lnc43",null,g,D),R=J(V,1,"board-container svelte-1lnc43",null,R,W)},[()=>({"wide-layout":r(v)}),()=>({"wide-layout":r(v)}),()=>({"square-layout":r(s)})],H),de("innerWidth",f=>M(w,f)),de("innerHeight",f=>M(C,f)),y(i,B),F()}function ht(i,e){q(e,!1);let s=_(e,"data",8);U(),at(i,{get levelId(){return s().levelId},get initialBoard(){return s().board}}),F()}export{ht as component,bt as universal};
