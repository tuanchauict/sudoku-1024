var _e=Object.defineProperty;var ye=(a,e,l)=>e in a?_e(a,e,{enumerable:!0,configurable:!0,writable:!0,value:l}):a[e]=l;var I=(a,e,l)=>ye(a,typeof e!="symbol"?e+"":e,l);import{b as ke,d as Me,g as Be,a as W,e as Q,i as Z,c as Ie,f as be,L as $}from"../chunks/B8yZZAnn.js";import{R as Ae,w as K,d as J,g as me}from"../chunks/CsgM81cj.js";import{t as V,a as M,c as Ne,n as pe}from"../chunks/DIIDYpGi.js";import"../chunks/BeDarhzi.js";import{h as ie,aH as Ve,aI as xe,y as j,aJ as ee,K as S,ap as _,o as oe,aK as ne,B as g,C as b,z as T,R as z,n as c,A as O,x as Ee,D as P,aq as ce,ar as ge,aL as Pe,aM as Ue}from"../chunks/DIEbNu-8.js";import{l as Ge,w as De,e as R,s as Y,h as we}from"../chunks/DpsPETUy.js";import{i as q}from"../chunks/A7uYnZF_.js";import{p as N}from"../chunks/DKACdnMP.js";import{i as ae}from"../chunks/Dd6kOlDc.js";import{o as te}from"../chunks/AyJ1svMD.js";function H(a,e,l,t,s,o){var n=a.__className;if(ie||n!==l){var u=ke(l,t,o);(!ie||u!==a.getAttribute("class"))&&(u==null?a.removeAttribute("class"):a.className=u),a.__className=l}else if(o&&s!==o)for(var r in o){var i=!!o[r];(s==null||i!==!!s[r])&&a.classList.toggle(r,i)}return o}function ue(a,e){Ge(window,["resize"],()=>De(()=>e(window[a])))}function Le(a){const e=Me(a);if(e===null||e.length!==81)return null;const l=[];for(let t=0;t<9;t++){const s=[];for(let o=0;o<9;o++)s.push(e[t*9+o]);l.push(s)}return l}function X(a,e){throw new Ae(a,e.toString())}new TextEncoder;const Re=({url:a})=>{const e=a.searchParams.get("game");if(!e)throw X(303,W("/"));const l=parseInt(e[0]);if(isNaN(l)||l<1||l>4)throw X(303,W("/"));const t=l;if(!t)throw X(303,W("/"));let s=e.substring(1);const o=s?Le(s):null;if(!o)throw s=Be.generateBoardString(t),X(303,`play?game=${l}${s}`);return{levelId:t,board:o}},Mt=Object.freeze(Object.defineProperty({__proto__:null,load:Re},Symbol.toStringTag,{value:"Module"})),Ce=Symbol("sudoku-view-model");function Te(a){Ve(Ce,a)}function le(){return xe(Ce)}var ze=V('<span class="cell-value svelte-9jn413"> </span>'),He=V('<div class="note-cell svelte-9jn413"><span class="note-value svelte-9jn413"></span></div>'),je=V('<div class="notes-grid svelte-9jn413"></div>'),Oe=V("<div><!></div>");function qe(a,e){j(e,!1);const l=_();let t=N(e,"rowIndex",8),s=N(e,"colIndex",8),o=N(e,"cellValue",8),n=N(e,"isInitial",8),u=N(e,"notes",8),r=N(e,"selectedCell",8),i=N(e,"valueCounts",8),y=N(e,"violatedCells",8);const f=le();function w(v,p){return f.isSameBox(v,p)}function k(v,p){return f.hasSameValue(v,p)}ee(()=>(oe(y()),oe(t()),oe(s())),()=>{S(l,y().some(v=>v.row===t()&&v.col===s()))}),ne(),q();var h=Oe();let C;var A=g(h);{var x=v=>{var p=ze(),D=g(p,!0);b(p),T(()=>Y(D,o())),M(v,p)},G=v=>{var p=je();Q(p,4,()=>Array(9).fill(null),Z,(D,U,B)=>{var d=Ne(),E=Ee(d);{var m=F=>{var se=He(),Se=g(se);Se.textContent=B+1,b(se),M(F,se)};ae(E,F=>{u()[B]&&F(m)})}M(D,d)}),b(p),M(v,p)};ae(A,v=>{o()?v(x):v(G,!1)})}b(h),T(v=>C=H(h,1,"cell svelte-9jn413",null,C,v),[()=>({selected:r().row===t()&&r().col===s(),"same-line":r().row===t()||r().col===s(),"same-box":w(t(),s())&&!(r().row===t()&&r().col===s()),"same-value":k(t(),s())&&!(r().row===t()&&r().col===s()),complete:o()&&i()[o()]>=9,violated:c(l),initial:n()})],z),R("click",h,()=>f.selectCell(t(),s())),M(a,h),O()}var Ke=V("<div><!></div>"),Je=V('<div class="row svelte-41cq0t"></div>'),Fe=V('<div class="sudoku-board svelte-41cq0t"></div>');function We(a,e){j(e,!1);let l=_([]),t=_([]),s=_({row:-1,col:-1});const o=le();let n=_([]),u=_([]);te(()=>{const i=o.board.subscribe(h=>{S(l,h)}),y=o.notes.subscribe(h=>{S(t,h)}),f=o.selectedCell.subscribe(h=>{S(s,h)}),w=o.valueCounts.subscribe(h=>{S(n,h)}),k=o.violatedCells.subscribe(h=>{S(u,h)});return()=>{i(),y(),f(),w(),k()}}),q();var r=Fe();Q(r,5,()=>c(l),Z,(i,y,f)=>{var w=Je();Q(w,5,()=>c(y),Z,(k,h,C)=>{var A=Ke();H(A,1,"cell svelte-41cq0t",null,{},{"border-bottom-thick":f%3===2&&f<8,"border-right-thick":C%3===2&&C<8});var x=g(A);const G=z(()=>o.isInitial(f,C));qe(x,{rowIndex:f,colIndex:C,get cellValue(){return c(h)},get isInitial(){return c(G)},get notes(){return c(t)[f][C]},get selectedCell(){return c(s)},get valueCounts(){return c(n)},get violatedCells(){return c(u)}}),b(A),M(k,A)}),b(w),M(i,w)}),b(r),M(a,r),O()}var Ye=pe('<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path></svg>');function Xe(a){var e=Ye();M(a,e)}var Qe=V('<div class="container svelte-1kf9c29"><p class="tip svelte-1kf9c29">Tip: Select a cell and press 1-9 to enter values. Use note mode for candidates.</p> <p class="tip svelte-1kf9c29">Any issue or suggestion? <br>Please report on <a href="https://github.com/tuanchauict/sudoku-1024/" target="_blank" class="svelte-1kf9c29">GitHub</a> of the project.</p></div>');function Ze(a){var e=Qe();M(a,e)}var $e=pe('<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" stroke="none" viewBox="0 0 24 24"><path d="M12.5 8c-2.65 0-5.05.99-6.9 2.6L2 7v9h9l-3.62-3.62c1.39-1.16 3.16-1.88 5.12-1.88 3.54 0 6.55 2.31 7.6 5.5l2.37-.78C21.08 11.03 17.15 8 12.5 8z"></path></svg>');function et(a){var e=$e();M(a,e)}var tt=V("<button> </button>"),lt=V('<div class="container svelte-1a5ihr1"><div class="digits-container svelte-1a5ihr1"><!> <button class="btn clear-btn svelte-1a5ihr1"><span>&#10005;</span></button></div> <div class="actions-container svelte-1a5ihr1"><button class="btn action-button svelte-1a5ihr1"><!> <span>Undo</span></button> <button><!> <span>Note</span></button></div> <!></div>');function st(a,e){j(e,!1);let l=_(Array(10).fill(0)),t=_(!1),s=_(!0),o=_(!1);const n=le();function u(v){n.enterDigit(v)}te(()=>{const v=n.noteMode.subscribe(B=>{S(t,B)}),p=n.cellEditable.subscribe(B=>{S(s,B)}),D=n.canUndo.subscribe(B=>{S(o,B)}),U=n.valueCounts.subscribe(B=>{S(l,B)});return()=>{v(),p(),D(),U()}}),q();var r=lt(),i=g(r),y=g(i);Q(y,0,()=>Array(9).fill(null),Z,(v,p,D)=>{var U=tt();const B=z(()=>D+1),d=z(()=>c(l)[D+1]);let E;var m=g(U,!0);b(U),T(F=>{E=H(U,1,"btn digit-button svelte-1a5ihr1",null,E,F),U.disabled=c(d)>=9,Y(m,c(B))},[()=>({disabled:c(d)>=9})],z),R("click",U,()=>u(c(B))),M(v,U)});var f=P(y,2);b(i);var w=P(i,2),k=g(w),h=g(k);et(h),ce(2),b(k);var C=P(k,2);let A;var x=g(C);Xe(x),ce(2),b(C),b(w);var G=P(w,2);Ze(G),b(r),T(v=>{f.disabled=!c(s),k.disabled=!c(o),A=H(C,1,"btn action-button note-btn svelte-1a5ihr1",null,A,v)},[()=>({active:c(t)})],z),R("click",f,()=>n.clearSelectedCell()),R("click",k,()=>n.undo()),R("click",C,()=>n.toggleNoteMode()),M(a,r),O()}const ot="sudoku";class de{static saveCurrentGame(e,l,t){const s={state:l,timePass:t};localStorage.setItem(ve(e),JSON.stringify(s))}static loadCurrentGame(e){const l=localStorage.getItem(ve(e));if(!l)return null;const t=JSON.parse(l);return t.state?t:null}}function ve(a){const e=a.flatMap(l=>l);return`${ot}_${Ie(e)}`}function re(a,e){return JSON.stringify(a)===JSON.stringify(e)}function L(a){let e;return a.subscribe(t=>{e=t})(),e}function fe(a){const e=[],l=(t,s)=>e.some(o=>o.row===t&&o.col===s);for(let t=0;t<9;t++)for(let s=0;s<9;s++){const o=a[t][s];if(!o||l(t,s))continue;for(let r=0;r<9;r++)r!==s&&a[t][r]===o&&(l(t,s)||e.push({row:t,col:s}),l(t,r)||e.push({row:t,col:r}));for(let r=0;r<9;r++)r!==t&&a[r][s]===o&&(l(t,s)||e.push({row:t,col:s}),l(r,s)||e.push({row:r,col:s}));const n=Math.floor(t/3)*3,u=Math.floor(s/3)*3;for(let r=n;r<n+3;r++)for(let i=u;i<u+3;i++)(r!==t||i!==s)&&a[r][i]===o&&(l(t,s)||e.push({row:t,col:s}),l(r,i)||e.push({row:r,col:i}))}return e}function at(a,e){for(let l=0;l<9;l++)for(let t=0;t<9;t++)if(e.board[l][t]!==a.board[l][t])return{row:l,col:t};for(let l=0;l<9;l++)for(let t=0;t<9;t++)if(!re(e.notes[l][t],a.notes[l][t]))return{row:l,col:t};return{row:0,col:0}}function rt(a){const e=Array(10).fill(0);for(let l=0;l<9;l++)for(let t=0;t<9;t++)a[l][t]&&e[a[l][t]]++;return e}const he=be(0,Array(9).fill(Array(9).fill(0)));class nt{constructor(){I(this,"initialBoard",he.initialBoard);I(this,"state",K(he));I(this,"stateHistoryStack",[]);I(this,"board");I(this,"notes");I(this,"selectedCell");I(this,"noteMode",K(!1));I(this,"valueCounts");I(this,"cellEditable");I(this,"violatedCells");I(this,"gameComplete",K(!1));I(this,"timePass",K(0));I(this,"timeStart",K(Date.now()));I(this,"canUndo",K(!1));this.board=J(this.state,e=>e.board),this.notes=J(this.state,e=>e.notes),this.selectedCell=J(this.state,e=>e.selectedCell),this.valueCounts=J(this.board,e=>rt(e)),this.cellEditable=J(this.selectedCell,e=>this.isEditableCell(e.row,e.col)),this.violatedCells=J(this.board,e=>fe(e))}init(e,l){const t=de.loadCurrentGame(l),s=t?t.state:be(e,l);this.state.set(s),this.initialBoard=l,this.stateHistoryStack.length=0,this.timePass.set(t?t.timePass:0),this.timeStart.set(Date.now())}get isInNodeMode(){return L(this.noteMode)}clearBoard(){this.updateState(e=>({...e,board:this.initialBoard,notes:Array(9).fill(null).map(()=>Array(9).fill(null).map(()=>Array(9).fill(!1))),noteMode:!1})),this.gameComplete.set(!1)}selectCell(e,l){this.updateState(t=>({...t,selectedCell:{row:e,col:l}}))}toggleNoteMode(){this.noteMode.set(!this.isInNodeMode)}enterDigit(e){this.updateState(l=>{const{row:t,col:s}=l.selectedCell;if(!this.isEditableCell(t,s))return l;const o=[...l.board.map(u=>[...u])],n=[...l.notes.map(u=>[...u.map(r=>[...r])])];if(this.isInNodeMode)n[t][s][e-1]=!n[t][s][e-1];else{o[t][s]=e;const u=Math.floor(t/3)*3,r=Math.floor(s/3)*3;for(let i=0;i<9;i++){n[t][i][e-1]=!1,n[i][s][e-1]=!1;const y=u+Math.floor(i/3),f=r+i%3;n[y][f][e-1]=!1}}return{...l,board:o,notes:n}}),this.updateCompleteState()}clearSelectedCell(){this.updateState(e=>{const{row:l,col:t}=e.selectedCell;if(!this.isEditableCell(l,t))return e;const s=[...e.board.map(n=>[...n])],o=[...e.notes.map(n=>[...n.map(u=>[...u])])];return s[l][t]!==0?s[l][t]=0:o[l][t]=Array(9).fill(!1),{...e,board:s,notes:o}}),this.gameComplete.set(!1)}undo(){const e=this.stateHistoryStack.pop();e&&(this.state.set({...e,selectedCell:at(e,L(this.state))}),this.canUndo.set(this.stateHistoryStack.length>0))}isInitial(e,l){return this.initialBoard[e][l]!==0}isSameBox(e,l){const t=L(this.selectedCell);if(!t||t.row===-1||t.col===-1)return!1;const s=Math.floor(e/3),o=Math.floor(l/3),n=Math.floor(t.row/3),u=Math.floor(t.col/3);return s===n&&o===u}hasSameValue(e,l){const t=L(this.selectedCell),s=L(this.board);if(!t||!s||t.row===-1||t.col===-1)return!1;const o=s[t.row][t.col];return!!(o&&s[e][l]===o)}isEditableCell(e,l){return e===-1||l===-1?!1:this.initialBoard[e][l]===0}updateCompleteState(){const e=L(this.board);if(!e.every(s=>s.every(o=>o>0))){this.gameComplete.set(!1);return}if(fe(e).length>0){this.gameComplete.set(!1);return}this.gameComplete.set(!0)}updateState(e){this.state.update(l=>{const t=e(l),s=L(this.timeStart),o=L(this.timePass)+(Date.now()-s)/1e3;return de.saveCurrentGame(this.initialBoard,t,o),re(l.board,t.board)&&re(l.notes,t.notes)||(this.stateHistoryStack.push(l),this.canUndo.set(!0)),t})}}var it=V('<div class="overlay svelte-m821eu"><div class="complete-card svelte-m821eu"><h2 class="svelte-m821eu">Puzzle Completed!</h2> <p class="svelte-m821eu"> </p> <button class="new-game-btn svelte-m821eu">New Game</button></div></div>');function ct(a,e){j(e,!1);let l=N(e,"levelId",8);function t(){me(W("/"))}q();var s=it();we(i=>{T(()=>ge.title=`Sudoku 1024: ${$[l()].name??""} Complete`)});var o=g(s),n=P(g(o),2),u=g(n);b(n);var r=P(n,2);b(o),b(s),T(()=>Y(u,`Congratulations! You've successfully completed the ${$[l()].name??""} puzzle.`)),R("click",r,t),M(a,s),O()}var ut=V('<div class="header svelte-1fp9g2h"><button class="back-btn svelte-1fp9g2h">Back</button> <div class="title svelte-1fp9g2h"><h1 class="svelte-1fp9g2h"> </h1> <h2 class="svelte-1fp9g2h"> </h2></div> <button class="clear-btn svelte-1fp9g2h">Reset</button></div>');function dt(a,e){j(e,!1);const l=_();let t=N(e,"levelId",8);const s=le();let o=_(0),n=!1;function u(){me(W("/"))}function r(){s.clearBoard()}te(()=>{const x=setInterval(()=>{n||Pe(o)},1e3),G=s.timePass.subscribe(p=>{S(o,p)}),v=s.gameComplete.subscribe(p=>{n=p});return()=>{clearInterval(x),G(),v()}}),ee(()=>c(o),()=>{S(l,new Date(c(o)*1e3).toISOString().substr(11,8))}),ne(),q();var i=ut(),y=g(i),f=P(y,2),w=g(f),k=g(w,!0);b(w);var h=P(w,2),C=g(h,!0);b(h),b(f);var A=P(f,2);b(i),T(()=>{Y(k,$[t()].name),Y(C,c(l))}),R("click",y,u),R("click",A,r),M(a,i),O()}var vt=V('<div><!> <div><div><!></div> <div class="controls-container svelte-1lbps5s"><!></div></div> <!></div>');function ft(a,e){j(e,!1);const l=_();let t=N(e,"levelId",8),s=N(e,"initialBoard",8);const o=new nt;o.init(t(),s()),Te(o);let n=_(!1),u=_(!1),r=_(0),i=_(0);te(()=>{const d=o.gameComplete.subscribe(E=>{S(n,E)});return()=>{d()}});function y(d){if(!c(n))if(d.key.match(/[1-9]/)){const E=parseInt(d.key,10);o.enterDigit(E)}else d.key==="Backspace"?o.clearSelectedCell():d.key==="Enter"||d.key===" "?o.toggleNoteMode():d.key==="ArrowUp"?f(-1,0):d.key==="ArrowDown"?f(1,0):d.key==="ArrowLeft"?f(0,-1):d.key==="ArrowRight"?f(0,1):d.key==="z"&&(d.ctrlKey||d.metaKey)&&o.undo()}function f(d,E){const m=L(o.selectedCell);m.row===-1||m.col===-1?(m.row=0,m.col=0):(m.row+=d,m.col+=E),m.row<0&&(m.row=8),m.row>8&&(m.row=0),m.col<0&&(m.col=8),m.col>8&&(m.col=0),o.selectCell(m.row,m.col)}ee(()=>(c(r),c(i)),()=>{S(u,c(r)>c(i)||c(r)>650)}),ee(()=>(c(i),c(u),c(r)),()=>{S(l,c(i)>0&&!c(u)&&c(r)/c(i)>.65)}),ne(),q();var w=vt();R("keydown",Ue,y);let k;var h=g(w);dt(h,{get levelId(){return t()}});var C=P(h,2);let A;var x=g(C);let G;var v=g(x);We(v,{}),b(x);var p=P(x,2),D=g(p);st(D,{}),b(p),b(C);var U=P(C,2);{var B=d=>{ct(d,{get levelId(){return t()}})};ae(U,d=>{c(n)&&d(B)})}b(w),T((d,E,m)=>{k=H(w,1,"container svelte-1lbps5s",null,k,d),A=H(C,1,"game-content svelte-1lbps5s",null,A,E),G=H(x,1,"board-container svelte-1lbps5s",null,G,m)},[()=>({"wide-layout":c(u)}),()=>({"wide-layout":c(u)}),()=>({"square-layout":c(l)})],z),ue("innerWidth",d=>S(r,d)),ue("innerHeight",d=>S(i,d)),M(a,w),O()}function Bt(a,e){j(e,!1);let l=N(e,"data",8);q(),we(t=>{T(()=>ge.title=`Sudoku 1024: ${$[l().levelId].name??""}`)}),ft(a,{get levelId(){return l().levelId},get initialBoard(){return l().board}}),O()}export{Bt as component,Mt as universal};
