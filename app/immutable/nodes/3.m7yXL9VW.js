var xe=Object.defineProperty;var Ae=(a,e,l)=>e in a?xe(a,e,{enumerable:!0,configurable:!0,writable:!0,value:l}):a[e]=l;var I=(a,e,l)=>Ae(a,typeof e!="symbol"?e+"":e,l);import{b as Ne,d as Ve,g as Ee,a as F,e as Z,i as $,c as Pe,f as ge,L as ee}from"../chunks/BWoGIW1L.js";import{R as Ue,w as q,d as J,g as Ce}from"../chunks/C_k4jdLR.js";import{l as Ge,w as De,t as N,e as z,a as S,d as ue,n as Se}from"../chunks/CYBOIRDU.js";import{i as R}from"../chunks/D2h7i0by.js";import{h as de,aH as Te,aI as Le,x as O,aJ as te,K as _,ai as k,t as re,aK as ne,B as p,C as b,z as L,T as H,q as c,A as K,y as ve,ah as le,D as G,af as fe,ag as _e,aL as ze,aM as He}from"../chunks/DCjUhcBe.js";import{s as W,h as ke}from"../chunks/ki9Jwg_P.js";import{p as A}from"../chunks/D8GkmtlV.js";import{i as Q}from"../chunks/D1405Ep2.js";function j(a,e,l,t,s,o){var i=a.__className;if(de||i!==l){var d=Ne(l,t,o);(!de||d!==a.getAttribute("class"))&&(d==null?a.removeAttribute("class"):a.className=d),a.__className=l}else if(o&&s!==o)for(var r in o){var n=!!o[r];(s==null||n!==!!s[r])&&a.classList.toggle(r,n)}return o}function he(a,e){Ge(window,["resize"],()=>De(()=>e(window[a])))}function je(a){const e=Ve(a);if(e===null||e.length!==81)return null;const l=[];for(let t=0;t<9;t++){const s=[];for(let o=0;o<9;o++)s.push(e[t*9+o]);l.push(s)}return l}function X(a,e){throw new Ue(a,e.toString())}new TextEncoder;const Re=({url:a})=>{const e=a.searchParams.get("game");if(!e)throw X(303,F("/"));const l=parseInt(e[0]);if(isNaN(l)||l<1||l>4)throw X(303,F("/"));const t=l;if(!t)throw X(303,F("/"));let s=e.substring(1);const o=s?je(s):null;if(!o)throw s=Ee.generateBoardString(t),X(303,`play?game=${l}${s}`);return{levelId:t,board:o}},It=Object.freeze(Object.defineProperty({__proto__:null,load:Re},Symbol.toStringTag,{value:"Module"})),ye=Symbol("sudoku-view-model");function Oe(a){Te(ye,a)}function se(){return Le(ye)}var Ke=N('<span class="cell-value svelte-1jwvdpo"> </span>'),qe=N('<div class="note-cell svelte-1jwvdpo"><span class="note-value svelte-1jwvdpo"></span></div>'),Je=N('<div class="notes-grid svelte-1jwvdpo"></div>'),Fe=N("<div><!></div>");function We(a,e){O(e,!1);const l=k();let t=A(e,"rowIndex",8),s=A(e,"colIndex",8),o=A(e,"cellValue",8),i=A(e,"isInitial",8),d=A(e,"notes",8),r=A(e,"selectedCell",8),n=A(e,"valueCounts",8),y=A(e,"violatedCells",8);const v=se();function g(f,M){return v.isSameBox(f,M)}function C(f,M){return v.hasSameValue(f,M)}te(()=>(re(y()),re(t()),re(s())),()=>{_(l,y().some(f=>f.row===t()&&f.col===s()))}),ne(),R();var h=Fe();let w;var x=p(h);{var V=f=>{var M=Ke(),D=p(M,!0);b(M),L(()=>W(D,o())),S(f,M)},E=f=>{var M=ue(),D=ve(M);{var P=B=>{var u=Je();Z(u,4,()=>Array(9).fill(null),$,(U,m,Y)=>{var ce=ue(),Me=ve(ce);{var Be=oe=>{var ae=qe(),Ie=p(ae);Ie.textContent=Y+1,b(ae),S(oe,ae)};Q(Me,oe=>{d()[Y]&&oe(Be)})}S(U,ce)}),b(u),S(B,u)};Q(D,B=>{d().some(u=>u)&&B(P)})}S(f,M)};Q(x,f=>{o()?f(V):f(E,!1)})}b(h),L(f=>w=j(h,1,"cell svelte-1jwvdpo",null,w,f),[()=>({selected:r().row===t()&&r().col===s(),"same-line":r().row===t()||r().col===s(),"same-box":g(t(),s())&&!(r().row===t()&&r().col===s()),"same-value":C(t(),s())&&!(r().row===t()&&r().col===s()),complete:o()&&n()[o()]>=9,violated:c(l),initial:i()})],H),z("click",h,()=>v.selectCell(t(),s())),S(a,h),K()}var Ye=N("<div><!></div>"),Xe=N('<div class="row svelte-1na93e9"></div>'),Qe=N('<div class="sudoku-board svelte-1na93e9"></div>');function Ze(a,e){O(e,!1);let l=k([]),t=k([]),s=k({row:-1,col:-1});const o=se();let i=k([]),d=k([]);le(()=>{const n=o.board.subscribe(h=>{_(l,h)}),y=o.notes.subscribe(h=>{_(t,h)}),v=o.selectedCell.subscribe(h=>{_(s,h)}),g=o.valueCounts.subscribe(h=>{_(i,h)}),C=o.violatedCells.subscribe(h=>{_(d,h)});return()=>{n(),y(),v(),g(),C()}}),R();var r=Qe();Z(r,5,()=>c(l),$,(n,y,v)=>{var g=Xe();Z(g,5,()=>c(y),$,(C,h,w)=>{var x=Ye();j(x,1,"cell svelte-1na93e9",null,{},{"border-bottom-thick":v%3===2&&v<8,"border-right-thick":w%3===2&&w<8});var V=p(x);const E=H(()=>o.isInitial(v,w));We(V,{rowIndex:v,colIndex:w,get cellValue(){return c(h)},get isInitial(){return c(E)},get notes(){return c(t)[v][w]},get selectedCell(){return c(s)},get valueCounts(){return c(i)},get violatedCells(){return c(d)}}),b(x),S(C,x)}),b(g),S(n,g)}),b(r),S(a,r),K()}var $e=Se('<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path></svg>');function et(a){var e=$e();S(a,e)}var tt=N('<div class="container svelte-1kf9c29"><p class="tip svelte-1kf9c29">Tip: Select a cell and press 1-9 to enter values. Use note mode for candidates.</p> <p class="tip svelte-1kf9c29">Any issue or suggestion? <br>Please report on <a href="https://github.com/tuanchauict/sudoku-1024/" target="_blank" class="svelte-1kf9c29">GitHub</a> of the project.</p></div>');function lt(a){var e=tt();S(a,e)}var st=Se('<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" stroke="none" viewBox="0 0 24 24"><path d="M12.5 8c-2.65 0-5.05.99-6.9 2.6L2 7v9h9l-3.62-3.62c1.39-1.16 3.16-1.88 5.12-1.88 3.54 0 6.55 2.31 7.6 5.5l2.37-.78C21.08 11.03 17.15 8 12.5 8z"></path></svg>');function ot(a){var e=st();S(a,e)}var at=N("<button> </button>"),rt=N('<div class="container svelte-1a5ihr1"><div class="digits-container svelte-1a5ihr1"><!> <button class="btn clear-btn svelte-1a5ihr1"><span>&#10005;</span></button></div> <div class="actions-container svelte-1a5ihr1"><button class="btn action-button svelte-1a5ihr1"><!> <span>Undo</span></button> <button><!> <span>Note</span></button></div> <!></div>');function it(a,e){O(e,!1);let l=k(Array(10).fill(0)),t=k(!1),s=k(!0),o=k(!1);const i=se();function d(f){i.enterDigit(f)}le(()=>{const f=i.noteMode.subscribe(B=>{_(t,B)}),M=i.cellEditable.subscribe(B=>{_(s,B)}),D=i.canUndo.subscribe(B=>{_(o,B)}),P=i.valueCounts.subscribe(B=>{_(l,B)});return()=>{f(),M(),D(),P()}}),R();var r=rt(),n=p(r),y=p(n);Z(y,0,()=>Array(9).fill(null),$,(f,M,D)=>{var P=at();const B=H(()=>D+1),u=H(()=>c(l)[D+1]);let U;var m=p(P,!0);b(P),L(Y=>{U=j(P,1,"btn digit-button svelte-1a5ihr1",null,U,Y),P.disabled=c(u)>=9,W(m,c(B))},[()=>({disabled:c(u)>=9})],H),z("click",P,()=>d(c(B))),S(f,P)});var v=G(y,2);b(n);var g=G(n,2),C=p(g),h=p(C);ot(h),fe(2),b(C);var w=G(C,2);let x;var V=p(w);et(V),fe(2),b(w),b(g);var E=G(g,2);lt(E),b(r),L(f=>{v.disabled=!c(s),C.disabled=!c(o),x=j(w,1,"btn action-button note-btn svelte-1a5ihr1",null,x,f)},[()=>({active:c(t)})],H),z("click",v,()=>i.clearSelectedCell()),z("click",C,()=>i.undo()),z("click",w,()=>i.toggleNoteMode()),S(a,r),K()}const nt="sudoku";class be{static saveCurrentGame(e,l,t){const s={state:l,timePass:t};localStorage.setItem(me(e),JSON.stringify(s))}static loadCurrentGame(e){const l=localStorage.getItem(me(e));if(!l)return null;const t=JSON.parse(l);return t.state?t:null}}function me(a){const e=a.flatMap(l=>l);return`${nt}_${Pe(e)}`}function ie(a,e){return JSON.stringify(a)===JSON.stringify(e)}function T(a){let e;return a.subscribe(t=>{e=t})(),e}function pe(a){const e=[],l=(t,s)=>e.some(o=>o.row===t&&o.col===s);for(let t=0;t<9;t++)for(let s=0;s<9;s++){const o=a[t][s];if(!o||l(t,s))continue;for(let r=0;r<9;r++)r!==s&&a[t][r]===o&&(l(t,s)||e.push({row:t,col:s}),l(t,r)||e.push({row:t,col:r}));for(let r=0;r<9;r++)r!==t&&a[r][s]===o&&(l(t,s)||e.push({row:t,col:s}),l(r,s)||e.push({row:r,col:s}));const i=Math.floor(t/3)*3,d=Math.floor(s/3)*3;for(let r=i;r<i+3;r++)for(let n=d;n<d+3;n++)(r!==t||n!==s)&&a[r][n]===o&&(l(t,s)||e.push({row:t,col:s}),l(r,n)||e.push({row:r,col:n}))}return e}function ct(a,e){for(let l=0;l<9;l++)for(let t=0;t<9;t++)if(e.board[l][t]!==a.board[l][t])return{row:l,col:t};for(let l=0;l<9;l++)for(let t=0;t<9;t++)if(!ie(e.notes[l][t],a.notes[l][t]))return{row:l,col:t};return{row:0,col:0}}function ut(a){const e=Array(10).fill(0);for(let l=0;l<9;l++)for(let t=0;t<9;t++)a[l][t]&&e[a[l][t]]++;return e}const we=ge(0,Array(9).fill(Array(9).fill(0)));class dt{constructor(){I(this,"initialBoard",we.initialBoard);I(this,"state",q(we));I(this,"stateHistoryStack",[]);I(this,"board");I(this,"notes");I(this,"selectedCell");I(this,"noteMode",q(!1));I(this,"valueCounts");I(this,"cellEditable");I(this,"violatedCells");I(this,"gameComplete",q(!1));I(this,"timePass",q(0));I(this,"timeStart",q(Date.now()));I(this,"canUndo",q(!1));this.board=J(this.state,e=>e.board),this.notes=J(this.state,e=>e.notes),this.selectedCell=J(this.state,e=>e.selectedCell),this.valueCounts=J(this.board,e=>ut(e)),this.cellEditable=J(this.selectedCell,e=>this.isEditableCell(e.row,e.col)),this.violatedCells=J(this.board,e=>pe(e))}init(e,l){const t=be.loadCurrentGame(l),s=t?t.state:ge(e,l);this.state.set(s),this.initialBoard=l,this.stateHistoryStack.length=0,this.timePass.set(t?t.timePass:0),this.timeStart.set(Date.now())}get isInNodeMode(){return T(this.noteMode)}clearBoard(){this.updateState(e=>({...e,board:this.initialBoard,notes:Array(9).fill(null).map(()=>Array(9).fill(null).map(()=>Array(9).fill(!1))),noteMode:!1})),this.gameComplete.set(!1)}selectCell(e,l){this.updateState(t=>({...t,selectedCell:{row:e,col:l}}))}toggleNoteMode(){this.noteMode.set(!this.isInNodeMode)}enterDigit(e){this.updateState(l=>{const{row:t,col:s}=l.selectedCell;if(!this.isEditableCell(t,s))return l;const o=[...l.board.map(d=>[...d])],i=[...l.notes.map(d=>[...d.map(r=>[...r])])];if(this.isInNodeMode)i[t][s][e-1]=!i[t][s][e-1];else{o[t][s]=e;const d=Math.floor(t/3)*3,r=Math.floor(s/3)*3;for(let n=0;n<9;n++){i[t][n][e-1]=!1,i[n][s][e-1]=!1;const y=d+Math.floor(n/3),v=r+n%3;i[y][v][e-1]=!1}}return{...l,board:o,notes:i}}),this.updateCompleteState()}clearSelectedCell(){this.updateState(e=>{const{row:l,col:t}=e.selectedCell;if(!this.isEditableCell(l,t))return e;const s=[...e.board.map(i=>[...i])],o=[...e.notes.map(i=>[...i.map(d=>[...d])])];return s[l][t]!==0?s[l][t]=0:o[l][t]=Array(9).fill(!1),{...e,board:s,notes:o}}),this.gameComplete.set(!1)}undo(){const e=this.stateHistoryStack.pop();e&&(this.state.set({...e,selectedCell:ct(e,T(this.state))}),this.canUndo.set(this.stateHistoryStack.length>0))}isInitial(e,l){return this.initialBoard[e][l]!==0}isSameBox(e,l){const t=T(this.selectedCell);if(!t||t.row===-1||t.col===-1)return!1;const s=Math.floor(e/3),o=Math.floor(l/3),i=Math.floor(t.row/3),d=Math.floor(t.col/3);return s===i&&o===d}hasSameValue(e,l){const t=T(this.selectedCell),s=T(this.board);if(!t||!s||t.row===-1||t.col===-1)return!1;const o=s[t.row][t.col];return!!(o&&s[e][l]===o)}isEditableCell(e,l){return e===-1||l===-1?!1:this.initialBoard[e][l]===0}updateCompleteState(){const e=T(this.board);if(!e.every(s=>s.every(o=>o>0))){this.gameComplete.set(!1);return}if(pe(e).length>0){this.gameComplete.set(!1);return}this.gameComplete.set(!0)}updateState(e){this.state.update(l=>{const t=e(l),s=T(this.timeStart),o=T(this.timePass)+(Date.now()-s)/1e3;return be.saveCurrentGame(this.initialBoard,t,o),ie(l.board,t.board)&&ie(l.notes,t.notes)||(this.stateHistoryStack.push(l),this.canUndo.set(!0)),t})}}var vt=N('<div class="overlay svelte-m821eu"><div class="complete-card svelte-m821eu"><h2 class="svelte-m821eu">Puzzle Completed!</h2> <p class="svelte-m821eu"> </p> <button class="new-game-btn svelte-m821eu">New Game</button></div></div>');function ft(a,e){O(e,!1);let l=A(e,"levelId",8);function t(){Ce(F("/"))}R();var s=vt();ke(n=>{L(()=>_e.title=`Sudoku 1024: ${ee[l()].name??""} Complete`)});var o=p(s),i=G(p(o),2),d=p(i);b(i);var r=G(i,2);b(o),b(s),L(()=>W(d,`Congratulations! You've successfully completed the ${ee[l()].name??""} puzzle.`)),z("click",r,t),S(a,s),K()}var ht=N('<div class="header svelte-1xkek1d"><button class="back-btn svelte-1xkek1d">Back</button> <div class="title svelte-1xkek1d"><h1 class="svelte-1xkek1d"> </h1> <h2 class="svelte-1xkek1d"> </h2></div></div>');function bt(a,e){O(e,!1);const l=k();let t=A(e,"levelId",8);const s=se();let o=k(0),i=!1;function d(){Ce(F("/"))}le(()=>{const w=setInterval(()=>{i||ze(o)},1e3),x=s.timePass.subscribe(E=>{_(o,E)}),V=s.gameComplete.subscribe(E=>{i=E});return()=>{clearInterval(w),x(),V()}}),te(()=>c(o),()=>{_(l,new Date(c(o)*1e3).toISOString().substr(11,8))}),ne(),R();var r=ht(),n=p(r),y=G(n,2),v=p(y),g=p(v,!0);b(v);var C=G(v,2),h=p(C,!0);b(C),b(y),b(r),L(()=>{W(g,ee[t()].name),W(h,c(l))}),z("click",n,d),S(a,r),K()}var mt=N('<div><!> <div><div><!></div> <div class="controls-container svelte-1lbps5s"><!></div></div> <!></div>');function pt(a,e){O(e,!1);const l=k();let t=A(e,"levelId",8),s=A(e,"initialBoard",8);const o=new dt;o.init(t(),s()),Oe(o);let i=k(!1),d=k(!1),r=k(0),n=k(0);le(()=>{const u=o.gameComplete.subscribe(U=>{_(i,U)});return()=>{u()}});function y(u){if(!c(i))if(u.key.match(/[1-9]/)){const U=parseInt(u.key,10);o.enterDigit(U)}else u.key==="Backspace"?o.clearSelectedCell():u.key==="Enter"||u.key===" "?o.toggleNoteMode():u.key==="ArrowUp"?v(-1,0):u.key==="ArrowDown"?v(1,0):u.key==="ArrowLeft"?v(0,-1):u.key==="ArrowRight"?v(0,1):u.key==="z"&&(u.ctrlKey||u.metaKey)&&o.undo()}function v(u,U){const m=T(o.selectedCell);m.row===-1||m.col===-1?(m.row=0,m.col=0):(m.row+=u,m.col+=U),m.row<0&&(m.row=8),m.row>8&&(m.row=0),m.col<0&&(m.col=8),m.col>8&&(m.col=0),o.selectCell(m.row,m.col)}te(()=>(c(r),c(n)),()=>{_(d,c(r)>c(n)||c(r)>650)}),te(()=>(c(n),c(d),c(r)),()=>{_(l,c(n)>0&&!c(d)&&c(r)/c(n)>.65)}),ne(),R();var g=mt();z("keydown",He,y);let C;var h=p(g);bt(h,{get levelId(){return t()}});var w=G(h,2);let x;var V=p(w);let E;var f=p(V);Ze(f,{}),b(V);var M=G(V,2),D=p(M);it(D,{}),b(M),b(w);var P=G(w,2);{var B=u=>{ft(u,{get levelId(){return t()}})};Q(P,u=>{c(i)&&u(B)})}b(g),L((u,U,m)=>{C=j(g,1,"container svelte-1lbps5s",null,C,u),x=j(w,1,"game-content svelte-1lbps5s",null,x,U),E=j(V,1,"board-container svelte-1lbps5s",null,E,m)},[()=>({"wide-layout":c(d)}),()=>({"wide-layout":c(d)}),()=>({"square-layout":c(l)})],H),he("innerWidth",u=>_(r,u)),he("innerHeight",u=>_(n,u)),S(a,g),K()}function xt(a,e){O(e,!1);let l=A(e,"data",8);R(),ke(t=>{L(()=>_e.title=`Sudoku 1024: ${ee[l().levelId].name??""}`)}),pt(a,{get levelId(){return l().levelId},get initialBoard(){return l().board}}),K()}export{xt as component,It as universal};
